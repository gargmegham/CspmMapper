{"status": 200, "code": 0, "data": [{"id": 1362, "name": "1.1 Ensure that corporate login credentials are used", "description": "Use corporate login credentials instead of personal accounts, such as Gmail accounts.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 728, "cloud": "google", "query": "corporateEmailsOnly", "title": "Corporate Emails Only", "description": "Ensures that no users are using their Gmail accounts for access to GCP.", "more_info": "Gmail accounts are personally created and are not controlled by organizations. Fully managed accounts are recommended for increased visibility, auditing and control over access to resources.", "recommended_action": "Ensure that no users are actively using their Gmail accounts to access GCP.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/corporate-emails-only/", "link": "https://cloud.google.com/iam/docs/overview", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712826, "result": 2, "resource": "user:gargmegham3@gmail.com", "message": "Account is using Gmail login credentials", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 728}]}]}, {"id": 1365, "name": "1.4 Ensure that there are only GCP-managed service account keys for each service account", "description": "User managed service accounts should not have user-managed keys.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 681, "cloud": "google", "query": "serviceAccountManagedKeys", "title": "Service Account Managed Keys", "description": "Ensures that service account keys are being managed by Google.", "more_info": "Service account keys should be managed by Google to ensure that they are as secure as possible, including key rotations and restrictions to the accessibility of the keys.", "recommended_action": "Ensure all user service account keys are being managed by Google.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/service-account-managed-keys/", "link": "https://cloud.google.com/iam/docs/creating-managing-service-account-keys", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712797, "result": 0, "resource": null, "message": "No service account keys found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 681}]}]}, {"id": 1366, "name": "1.5 Ensure that Service Account has no Admin privileges", "description": "A service account is a special Google account that belongs to an application or a VM, instead of to an individual end-user. The application uses the service account to call the service's Google API so that users aren't directly involved. It's recommended not to use admin access for ServiceAccount.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 710, "cloud": "google", "query": "serviceAccountAdmin", "title": "Service Account Admin", "description": "Ensures that user managed service accounts do not have any admin, owner, or write privileges.", "more_info": "Service accounts are primarily used for API access to Google. It is recommended to not use admin access for service accounts.", "recommended_action": "Ensure that no service accounts have admin, owner, or write privileges.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/service-account-admin/", "link": "https://cloud.google.com/iam/docs/overview", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712818, "result": 0, "resource": null, "message": "All service accounts have least access", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 710}]}]}, {"id": 1367, "name": "1.6 Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level", "description": "It is recommended to assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator (iam.serviceAccountTokenCreator) roles to a user for a specific service account rather than assigning the role to a user at project level.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 711, "cloud": "google", "query": "serviceAccountUser", "title": "Service Account User", "description": "Ensures that no users have the Service Account User role.", "more_info": "The Service Account User role gives users the access to all service accounts of a project. This can result in an elevation of privileges and is not recommended.", "recommended_action": "Ensure that no service accounts have the Service Account User role attached.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/service-account-user/", "link": "https://cloud.google.com/iam/docs/overview", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712819, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 711}]}]}, {"id": 1368, "name": "1.7 Ensure user-managed/external keys for service accounts are rotated every 90 days or less", "description": "Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests users make to Google cloud services accessible to that particular service account. It is recommended that all Service Account keys are regularly rotated.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 680, "cloud": "google", "query": "serviceAccountKeyRotation", "title": "Service Account Key Rotation", "description": "Ensures that service account keys are rotated within desired number of days.", "more_info": "Service account keys should be rotated so older keys that that might have been lost or compromised cannot be used to access Google services.", "recommended_action": "Rotate service account keys that have not been rotated in over defined threshold time.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/service-account-key-rotation/", "link": "https://cloud.google.com/iam/docs/creating-managing-service-account-keys", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712796, "result": 0, "resource": null, "message": "No service account keys found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 680}]}]}, {"id": 1369, "name": "1.8 Ensure that Separation of duties is enforced while assigning service account related roles to users", "description": "It is recommended that the principle of 'Separation of Duties' is enforced while assigning service-account related roles to users.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 712, "cloud": "google", "query": "serviceAccountSeparation", "title": "Service Account Separation", "description": "Ensures that no users have both the Service Account User and Service Account Admin role.", "more_info": "Ensuring that no users have both roles follows separation of duties, where no user should have access to resources out of the scope of duty.", "recommended_action": "Ensure that no service accounts have both the Service Account User and Service Account Admin role attached.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/service-account-separation/", "link": "https://cloud.google.com/iam/docs/overview", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712820, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 712}]}]}, {"id": 1372, "name": "1.11 Ensure that Separation of duties is enforced while assigning KMS related roles to users", "description": "It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 713, "cloud": "google", "query": "kmsUserSeparation", "title": "KMS User Separation", "description": "Ensures that no users have the KMS admin role and any one of the CryptoKey roles.", "more_info": "Ensuring that no users have the KMS admin role and any one of the CryptoKey roles follows separation of duties, where no user should have access to resources out of the scope of duty.", "recommended_action": "Ensure that no service accounts have both the KMS admin role and any of CryptoKey roles attached.", "cs_link": "https://avd.aquasec.com/cspm/google/iam/kms-user-separation/", "link": "https://cloud.google.com/iam/docs/overview", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21037712821, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 713}]}]}, {"id": 1377, "name": "2.1 Ensure that Cloud Audit Logging is configured properly across all services and all users from a project", "description": "It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 715, "cloud": "google", "query": "auditLoggingEnabled", "title": "Audit Logging Enabled", "description": "Ensures that default audit logging is enabled on the organization or project.", "more_info": "The default audit logs should be configured to log all admin activities and write and read access to data for all services. In addition, no exempted members should be added to the logs to ensure proper delivery of all audit logs.", "recommended_action": "Ensure that the default audit logs are enabled to log all admin activities and write and read access to data for all services.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/audit-logging-enabled/", "link": "https://cloud.google.com/logging/docs/audit/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712822, "result": 2, "resource": null, "message": "Audit logging is not enabled on the project", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 715}]}]}, {"id": 1378, "name": "2.2 Ensure that sinks are configured for all log entries", "description": "It is recommended to create a sink that will export copies of all the log entries. This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM).", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 716, "cloud": "google", "query": "logSinksEnabled", "title": "Log Sinks Enabled", "description": "Ensures a log sink is enabled to export all logs", "more_info": "Log sinks send log data to a storage service for archival and compliance. A log sink with no filter is necessary to ensure that all logs are being properly sent. If logs are sent to a storage bucket, the bucket must exist and bucket versioning should exist.", "recommended_action": "Ensure a log sink is configured properly with an empty filter and a destination.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/log-sinks-enabled/", "link": "https://cloud.google.com/logging/docs/export/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712823, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 716}]}]}, {"id": 1380, "name": "2.4 Ensure log metric filter and alerts exist for project ownership assignments/changes", "description": "In order to prevent unnecessary project ownership assignments to users/service-accounts and further misuses of projects and resources, all roles/Owner assignments should be monitored. Members (users/Service-Accounts) with a role assignment to primitive role roles/Owner are project owners. The project owner has all the privileges on the project the role belongs to. Granting the owner role to a member (user/Service-Account) will allow that member to modify the Identity and Access Management (IAM) policy. Therefore, grant the owner role only if the member has a legitimate purpose to manage the IAM policy. This is because the project IAM policy contains sensitive access control data. Having a minimal set of users allowed to manage IAM policy will simplify any auditing that may be necessary.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 684, "cloud": "google", "query": "projectOwnershipLogging", "title": "Project Ownership Logging", "description": "Ensures that logging and log alerts exist for project ownership assignments and changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in project ownership should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert exist for project ownership assignments and changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/project-ownership-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712799, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 684}]}]}, {"id": 1381, "name": "2.5 Ensure that the log metric filter and alerts exist for Audit Configuration changes", "description": "Google Cloud Platform (GCP) services write audit log entries to the Admin Activity and Data Access logs to help answer the questions of, \"\"who did what, where, and when?\"\" within GCP projects. Cloud audit logging records information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by GCP services. Cloud audit logging provides a history of GCP API calls for an account, including API calls made via the console, SDKs, command-line tools, and other GCP services.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 687, "cloud": "google", "query": "auditConfigurationLogging", "title": "Audit Configuration Logging", "description": "Ensures that logging and log alerts exist for audit configuration changes.", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in audit configuration should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log alerts exist for audit configuration changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/audit-configuration-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": []}]}, {"id": 1382, "name": "2.6 Ensure that the log metric filter and alerts exist for Custom Role changes", "description": "It is recommended that a metric filter and alarm be established for changes to Identity and Access Management (IAM) role creation, deletion and updating activities.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 688, "cloud": "google", "query": "customRoleLogging", "title": "Custom Role Logging", "description": "Ensures that logging and log alerts exist for custom role creation and changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in custom role should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log alerts exist for custom role creation and changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/custom-role-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712802, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 688}]}]}, {"id": 1383, "name": "2.7 Ensure that the log metric filter and alerts exist for VPC Network Firewall rule changes", "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) Network Firewall rule changes.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 689, "cloud": "google", "query": "vpcFirewallRuleLogging", "title": "VPC Firewall Rule Logging", "description": "Ensures that logging and log alerts exist for firewall rule changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in firewall rule should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert exist for firewall rule changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/vpc-firewall-rule-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712803, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 689}]}]}, {"id": 1384, "name": "2.8 Ensure that the log metric filter and alerts exist for VPC network route changes", "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) network route changes.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 690, "cloud": "google", "query": "vpcNetworkRouteLogging", "title": "VPC Network Route Logging", "description": "Ensures that logging and log alerts exist for VPC network route changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in VPC network route should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert exist for VPC network route changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/vpc-network-route-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712804, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 690}]}]}, {"id": 1385, "name": "2.9 Ensure that the log metric filter and alerts exist for VPC network changes", "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) network changes.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 691, "cloud": "google", "query": "vpcNetworkLogging", "title": "VPC Network Logging", "description": "Ensures that logging and log alerts exist for VPC network changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in VPC network should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert exist for VPC network changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/vpc-network-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712805, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 691}]}]}, {"id": 1386, "name": "2.10 Ensure that the log metric filter and alerts exist for Cloud Storage IAM permission changes", "description": "It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 685, "cloud": "google", "query": "storagePermissionsLogging", "title": "Storage Permissions Logging", "description": "Ensures that logging and log alerts exist for storage permission changes", "more_info": "Storage permissions include access to the buckets that store the logs, any changes in storage permissions should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert for storage permission changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/storage-permissions-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712800, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 685}]}]}, {"id": 1387, "name": "2.11 Ensure that the log metric filter and alerts exist for SQL instance configuration changes", "description": "It is recommended that a metric filter and alarm be established for SQL instance configuration changes.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 686, "cloud": "google", "query": "sqlConfigurationLogging", "title": "SQL Configuration Logging", "description": "Ensures that logging and log alerts exist for SQL configuration changes", "more_info": "Project Ownership is the highest level of privilege on a project, any changes in SQL configurations should be heavily monitored to prevent unauthorized changes.", "recommended_action": "Ensure that log metric and alert exist for SQL configuration changes.", "cs_link": "https://avd.aquasec.com/cspm/google/logging/sql-configuration-logging/", "link": "https://cloud.google.com/logging/docs/logs-based-metrics/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 168, "account_id": null, "test_domain_id": 7, "results": [{"id": 21037712801, "result": 2, "resource": null, "message": "No log metrics found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 686}]}]}, {"id": 1389, "name": "3.1 Ensure that the default network does not exist in a project", "description": "To prevent use of default network, a project should not have a default network.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 463, "cloud": "google", "query": "defaultVpcInUse", "title": "Default VPC In Use", "description": "Determines whether the default VPC is being used for launching VM instances", "more_info": "The default VPC should not be used in order to avoid launching multiple services in the same network which may not require connectivity. Each application, or network tier, should use its own VPC.", "recommended_action": "Move resources from the default VPC to a new VPC created for that application or resource group.", "cs_link": "https://avd.aquasec.com/cspm/google/vpc-network/default-vpc-in-use/", "link": "https://cloud.google.com/vpc/docs/vpc", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 123, "account_id": null, "test_domain_id": 13, "results": [{"id": 21037712624, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 463}]}]}, {"id": 1390, "name": "3.2 Ensure legacy networks do not exist for a project", "description": "In order to prevent use of legacy networks, a project should not have a legacy network configured.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 647, "cloud": "google", "query": "dnsSecEnabled", "title": "DNS Security Enabled", "description": "Ensures that DNS Security is enabled on all managed zones", "more_info": "DNS Security is a feature that authenticates all responses to domain name lookups. This prevents attackers from committing DNS hijacking or man in the middle attacks.", "recommended_action": "Ensure DNSSEC is enabled for all managed zones in the cloud DNS service.", "cs_link": "https://avd.aquasec.com/cspm/google/dns/dns-security-enabled/", "link": "https://cloud.google.com/dns/docs/dnssec", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 164, "account_id": null, "test_domain_id": 9, "results": [{"id": 21037712792, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 647}]}]}, {"id": 1392, "name": "3.4 Ensure that RSASHA1 is not used for the key-signing key in Cloud DNS DNSSEC", "description": "DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should be strong.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 675, "cloud": "google", "query": "dnsSecSigningAlgorithm", "title": "DNS Security Signing Algorithm", "description": "Ensures that DNS Security is not using the RSASHA1 algorithm for key or zone signing", "more_info": "DNS Security is a feature that authenticates all responses to domain name lookups. This prevents attackers from committing DNS hijacking or man in the middle attacks.", "recommended_action": "Ensure that all managed zones using DNSSEC are not using the RSASHA1 algorithm for key or zone signing.", "cs_link": "https://avd.aquasec.com/cspm/google/dns/dns-security-signing-algorithm/", "link": "https://cloud.google.com/dns/docs/dnssec", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 164, "account_id": null, "test_domain_id": 9, "results": [{"id": 21037712793, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 675}]}]}, {"id": 1393, "name": "3.5 Ensure that RSASHA1 is not used for the zone-signing key in Cloud DNS DNSSEC", "description": "DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should be strong.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 675, "cloud": "google", "query": "dnsSecSigningAlgorithm", "title": "DNS Security Signing Algorithm", "description": "Ensures that DNS Security is not using the RSASHA1 algorithm for key or zone signing", "more_info": "DNS Security is a feature that authenticates all responses to domain name lookups. This prevents attackers from committing DNS hijacking or man in the middle attacks.", "recommended_action": "Ensure that all managed zones using DNSSEC are not using the RSASHA1 algorithm for key or zone signing.", "cs_link": "https://avd.aquasec.com/cspm/google/dns/dns-security-signing-algorithm/", "link": "https://cloud.google.com/dns/docs/dnssec", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 164, "account_id": null, "test_domain_id": 9, "results": [{"id": 21037712793, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 675}]}]}, {"id": 1394, "name": "3.6 Ensure that SSH access is restricted from the internet", "description": "\"GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow the user to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances. Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, only an IPv4address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the internet to VPC or VM instance using SSH on Port 22 can be avoided.\"", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 443, "cloud": "google", "query": "openSSH", "title": "Open SSH", "description": "Determines if TCP port 22 for SSH is open to the public", "more_info": "While some ports such as HTTP and HTTPS are required to be open to the public to function properly, more sensitive services such as SSH should be restricted to known IP addresses.", "recommended_action": "Restrict TCP port 22 to known IP addresses.", "cs_link": "https://avd.aquasec.com/cspm/google/vpc-network/open-ssh/", "link": "https://cloud.google.com/vpc/docs/using-firewalls", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 123, "account_id": null, "test_domain_id": 13, "results": [{"id": 21037712604, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 443}]}]}, {"id": 1395, "name": "3.7 Ensure that RDP access is restricted from the Internet", "description": "GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow users to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances. Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. When specifying a source for an ingress rule or a destination for an egress rule by address, an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the Internet to a VPC or VM instance using RDP on Port 3389can be avoided.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 453, "cloud": "google", "query": "openRDP", "title": "Open RDP", "description": "Determines if TCP port 3389 for RDP is open to the public", "more_info": "While some ports such as HTTP and HTTPS are required to be open to the public to function properly, more sensitive services such as RDP should be restricted to known IP addresses.", "recommended_action": "Restrict TCP port 3389 to known IP addresses.", "cs_link": "https://avd.aquasec.com/cspm/google/vpcnetwork/open-rdp", "link": "https://cloud.google.com/vpc/docs/using-firewalls", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 123, "account_id": null, "test_domain_id": 13, "results": [{"id": 21037712614, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 453}]}]}, {"id": 1396, "name": "3.8 Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "description": "Flow Logs is a feature that enables users to capture information about the IP traffic going to and from network interfaces in the organization's VPC Subnets. Once a flow log is created, the user can view and retrieve its data in Stackdriver Logging. It is recommended that Flow Logs be enabled for every business-critical VPC subnet.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 561, "cloud": "google", "query": "flowLogsEnabled", "title": "Flow Logs Enabled", "description": "Ensures VPC flow logs are enabled for traffic logging", "more_info": "VPC flow logs record all traffic flowing in to and out of a VPC. These logs are critical for auditing and review after security incidents.", "recommended_action": "Enable VPC flow logs for each VPC subnet", "cs_link": "https://avd.aquasec.com/cspm/google/vpc-network/flow-logs-enabled/", "link": "https://cloud.google.com/vpc/docs/using-flow-logs", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 123, "account_id": null, "test_domain_id": 13, "results": [{"id": 21037712780, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 561}]}]}, {"id": 1399, "name": "4.1 Ensure that instances are not configured to use the default service account", "description": "It is recommended to configure your instance to not use the default Compute Engine service account because it has the Editor role on the project.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1081, "cloud": "google", "query": "instanceDefaultServiceAccount", "title": "Instance Default Service Account", "description": "Ensures that compute instances are not configured to use the default service account.", "more_info": "Default service account has the editor role permissions. Due to security reasons it should not be used for any instance.", "recommended_action": "Make sure that compute instances are not using default service account", "cs_link": "https://avd.aquasec.com/cspm/google/compute/instance-default-service-account", "link": "https://cloud.google.com/compute/docs/access/service-accounts", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712852, "result": 3, "resource": null, "message": "Unable to query for projects: 403", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1081}]}]}, {"id": 1400, "name": "4.2 Ensure that instances are not configured to use the default service account with full access to all Cloud APIs", "description": "To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account Compute Engine default service account with Scope Allow full access to all Cloud APIs.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 640, "cloud": "google", "query": "instanceLeastPrivilege", "title": "VM Instances Least Privilege", "description": "Ensures that instances are not configured to use the default service account with full access to all cloud APIs", "more_info": "To support the principle of least privilege and prevent potential privilege escalation, it is recommended that instances are not assigned to the default service account, Compute Engine default service account with a scope allowing full access to all cloud APIs.", "recommended_action": "For all instances, if the default service account is used, ensure full access to all cloud APIs is not configured.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/vm-instances-least-privilege/", "link": "https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712786, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 640}]}]}, {"id": 1401, "name": "4.3 Ensure \"Block Project-wide SSH keys\" is enabled for VM instances", "description": "It is recommended to use Instance specific SSH key(s) instead of using common/shared project-wide SSH key(s) to access Instances.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 639, "cloud": "google", "query": "instanceLevelSSHOnly", "title": "Instance Level SSH Only", "description": "Ensures that instances are not configured to allow project-wide SSH keys", "more_info": "To support the principle of least privilege and prevent potential privilege escalation it is recommended that instances are not give access to project-wide SSH keys through instance metadata.", "recommended_action": "Ensure project-wide SSH keys are blocked for all instances.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/instance-level-ssh-only/", "link": "https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712785, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 639}]}]}, {"id": 1402, "name": "4.4 Ensure oslogin is enabled for a Project", "description": "Enabling OS login binds SSH certificates to IAM users and facilitates effective SSH certificate management.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 678, "cloud": "google", "query": "osLoginEnabled", "title": "OS Login Enabled", "description": "Ensures OS login is enabled for the project", "more_info": "Enabling OS login ensures that SSH keys used to connect to instances are mapped with IAM users.", "recommended_action": "Set enable-oslogin in project-wide metadata so that it applies to all of the instances in the project.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/os-login-enabled/", "link": "https://cloud.google.com/compute/docs/instances/managing-instance-access", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712794, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 678}]}]}, {"id": 1403, "name": "4.5 Ensure 'Enable connecting to serial ports' is not enabled for VM Instance", "description": "Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 642, "cloud": "google", "query": "connectSerialPortsDisabled", "title": "Connect Serial Ports Disabled", "description": "Ensures connecting to serial ports is not enabled for VM instances", "more_info": "The serial console does not allow restricting IP Addresses, which allows any IP address to connect to instance and should therefore be disabled.", "recommended_action": "Ensure the Enable Connecting to Serial Ports option is disabled for all compute instances.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/connect-serial-ports-disabled/", "link": "https://cloud.google.com/compute/docs/instances/interacting-with-serial-console", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712788, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 642}]}]}, {"id": 1404, "name": "4.6 Ensure that IP forwarding is not enabled on Instances", "description": "Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets. Forwarding of data packets should be disabled to prevent data loss or information disclosure.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 641, "cloud": "google", "query": "ipForwardingDisabled", "title": "IP Forwarding Disabled", "description": "Ensures that IP forwarding is disabled on all instances", "more_info": "Disabling IP forwarding ensures that the instance only sends and receives packets with matching destination or source IPs.", "recommended_action": "IP forwarding settings can only be chosen when creating a new instance. Delete the affected instances and redeploy with IP forwarding disabled.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/ip-forwarding-disabled/", "link": "https://cloud.google.com/vpc/docs/using-routes", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712787, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 641}]}]}, {"id": 1405, "name": "4.7 Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Keys (CSEK)", "description": "Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 643, "cloud": "google", "query": "csekEncryptionEnabled", "title": "CSEK Encryption Enabled", "description": "Ensures Customer Supplied Encryption Key Encryption is enabled on disks", "more_info": "Google encrypts all disks at rest by default. By using CSEK only the users with the key can access the disk. Anyone else, including Google, cannot access the disk data.", "recommended_action": "CSEK can only be configured when creating a disk. Delete the disk and redeploy with CSEK.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/csek-encryption-enabled/", "link": "https://cloud.google.com/compute/docs/disks/customer-supplied-encryption", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712789, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 643}]}]}, {"id": 1406, "name": "4.8 Ensure Compute instances are launched with Shielded VM enabled", "description": "To defend against against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1082, "cloud": "google", "query": "shieldedVmEnabled", "title": "Shielded VM Enabled", "description": "Ensures that instances are configured with the shielded VM enabled", "more_info": "Shielded VM option should be configured to defend against the security attacks on the instances.", "recommended_action": "Enable the shielded VM for all the instances for security reasons.", "cs_link": "https://avd.aquasec.com/cspm/google/compute/shielded-vm-enabled", "link": "https://cloud.google.com/security/shielded-cloud/shielded-vm", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712853, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1082}]}]}, {"id": 1409, "name": "4.9 Ensure that Compute instances do not have public IP addresses", "description": "Compute instances should not be configured to have external IP addresses.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1080, "cloud": "google", "query": "instancePublicAccess", "title": "Instance Public Access Disabled", "description": "Ensures that compute instances are not configured to allow public access.", "more_info": "Compute Instances should always be configured behind load balancers instead of having public IP addresses in order to minimize the instance's exposure to the internet.", "recommended_action": "Modify compute instances and set External IP to None for network interface", "cs_link": "https://avd.aquasec.com/cspm/google/compute/instance-public-access-disabled", "link": "https://cloud.google.com/compute/docs/ip-addresses/reserve-static-external-ip-address", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 124, "account_id": null, "test_domain_id": 5, "results": [{"id": 21037712851, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1080}]}]}, {"id": 1410, "name": "5.1 Ensure that Cloud Storage bucket is not anonymously or publicly accessible", "description": "It is recommended that IAM policy on Cloud Storage bucket does not allows anonymous or public access.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 644, "cloud": "google", "query": "bucketAllUsersPolicy", "title": "Storage Bucket All Users Policy", "description": "Ensures Storage bucket policies do not allow global write, delete, or read permissions", "more_info": "Storage buckets can be configured to allow the global principal to access the bucket via the bucket policy. This policy should be restricted only to known users or accounts.", "recommended_action": "Ensure that each storage bucket is configured so that no member is set to allUsers or allAuthenticatedUsers.", "cs_link": "https://avd.aquasec.com/cspm/google/storage/storage-bucket-all-users-policy/", "link": "https://cloud.google.com/storage/docs/access-control/iam", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 127, "account_id": null, "test_domain_id": 3, "results": []}]}, {"id": 1411, "name": "5.2 Ensure that Cloud Storage buckets have uniform bucket-level access enabled", "description": "It is recommended to use uniform bucket-level access to unify and simplify how you grant access to your Cloud Storage resources. Enabling uniform bucket-level access guarantees that if a Storage bucket is not publicly accessible, no object in the bucket is publicly accessible either.", "program_id": 456, "tests": [{"remediation_apis": ["storage.buckets.update"], "realtime_triggers": ["storage.buckets.update", "storage.buckets.create"], "asl": null, "id": 1053, "cloud": "google", "query": "bucketUniformAccess", "title": "Bucket Uniform Level Access", "description": "Ensures that uniform level access is enabled on storage buckets.", "more_info": "Uniform level access for buckets can be used for managing access in a simple way. It enables us to use other security features like IAM conditions.", "recommended_action": "Make sure that storage buckets have uniform level access enabled", "cs_link": "https://avd.aquasec.com/cspm/google/storage/bucket-uniform-level-access", "link": "https://cloud.google.com/storage/docs/uniform-bucket-level-access#should-you-use", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": "202207281836", "remediation_description": "Unfiorm Level Access will be enabled on all storage buckets", "severity": "low", "no_new_risks": false, "category_id": 127, "account_id": null, "test_domain_id": 3, "results": [{"id": 21037712848, "result": 2, "resource": "b/chatbot-iytows.appspot.com", "message": "Bucket does not have uniform bucket level access enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1053}, {"id": 21037712849, "result": 2, "resource": "b/staging.chatbot-iytows.appspot.com", "message": "Bucket does not have uniform bucket level access enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1053}]}]}, {"id": 1414, "name": "6.1.3 Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'", "description": "It is recommended to set the local_infile database flag for a Cloud SQL MySQL instance to off.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 989, "cloud": "google", "query": "mysqlLocalInfile", "title": "MySQL Local Infile Disabled", "description": "Ensures SQL instances for MySQL type does not have local infile flag enabled.", "more_info": "SQL instances for MySQL type database provides local_infile flag, which can be used to load data from client or server systems. It controls the load data statements for database. Anyone using this server can access any file on the client system. For security reasons it should be disabled.", "recommended_action": "Ensure that local infile flag is disabled for all MySQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/mysql-local-infile-disabled", "link": "https://cloud.google.com/sql/docs/mysql/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712838, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 989}]}]}, {"id": 1415, "name": "6.2.1 Ensure that the 'log_checkpoints' database flag for Cloud SQL PostgreSQL instance is set to 'on'", "description": "Ensure that the log_checkpoints database flag for the Cloud SQL PostgreSQL instance is set to on.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 992, "cloud": "google", "query": "postgresqlLogCheckpoints", "title": "PostgreSQL Log Checkpoints Enabled", "description": "Ensure that log_checkpoints flag is enabled for PostgreSQL instances.", "more_info": "When log_checkpoints flag is enabled, instance checkpoints and restart points are logged in the server log.", "recommended_action": "Ensure that all PostgreSQL database instances have log_checkpoints flag and it value is set to on.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-checkpoints-enabled", "link": "https://cloud.google.com/sql/docs/postgres/flags#setting_a_database_flag", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712841, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 992}]}]}, {"id": 1417, "name": "6.2.3 Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'", "description": "Enabling the log_connections setting causes each attempted connection to the server to be logged, along with successful completion of client authentication. This parameter cannot be changed after the session starts.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 990, "cloud": "google", "query": "postgresqlLogConnections", "title": "PostgreSQL Log Connections Flag Enabled", "description": "Ensures SQL instances for PostgreSQL type have log connections flag enabled.", "more_info": "SQL instance for PostgreSQL databases provides log_connections flag. It is used to log every attempt to connect to the db server. It is not enabled by default. Enabling it will make sure to log all connection tries", "recommended_action": "Ensure that log connections flag is enabled for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-connections-flag-enabled", "link": "https://cloud.google.com/sql/docs/postgres/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712839, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 990}]}]}, {"id": 1418, "name": "6.2.4 Ensure that the 'log_disconnections' database flag for Cloud SQL PostgreSQL instance is set to 'on'", "description": "Enabling the log_disconnections setting logs the end of each session, including the session duration.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 991, "cloud": "google", "query": "postgresqlLogDisconnections", "title": "PostgreSQL Log Disconnections Flag Enabled", "description": "Ensures SQL instances for PostgreSQL type have log disconnections flag enabled.", "more_info": "SQL instance for PostgreSQL databases provides log_disconnections flag. It is used to log every attempt to connect to the DB server. It is not enabled by default. Enabling it will make sure to log anyone who disconnects from the instance.", "recommended_action": "Ensure that log disconnections flag is enabled for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-disconnections-flag-enabled", "link": "https://cloud.google.com/sql/docs/postgres/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712840, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 991}]}]}, {"id": 1420, "name": "6.2.6 Ensure that the 'log_lock_waits' database flag for Cloud SQL PostgreSQL instance is set to 'on'", "description": "Enabling the log_lock_waits flag for a PostgreSQL instance creates a log for any session waits that take longer than the alloted deadlock_timeout time to acquire a lock.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 988, "cloud": "google", "query": "postgresqlLogLockWaits", "title": "PostgreSQL Log Lock Waits Flag Enabled", "description": "Ensures SQL instances for PostgreSQL type have log_lock_waits flag enabled.", "more_info": "SQL instance for PostgreSQL database provides log_lock_waits flag. It is not enabled by default. Enabling it will make sure that log messages are generated whenever a session waits longer than deadlock_timeout to acquire a lock.", "recommended_action": "Ensure that log_lock_waits flag is enabled for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-lock-waits-flag-enabled", "link": "https://cloud.google.com/sql/docs/postgres/flags#config", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712837, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 988}]}]}, {"id": 1428, "name": "6.2.14 Ensure 'log_min_error_statement' database flag for Cloud SQL PostgreSQL instance is set to 'Error' or stricter", "description": "The log_min_error_statement flag defines the minimum message severity level that are considered as an error statement. Messages for error statements are logged with the SQL statement. Valid values include DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes the subsequent levels mentioned above. Ensure a value of ERROR or stricter is set.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1047, "cloud": "google", "query": "postgresqlLogMinError", "title": "PostgreSQL Log Min Error Statement", "description": "Ensures SQL instances for PostgreSQL type have log min error statement flag set to Error.", "more_info": "SQL instance for PostgreSQL databases provides log_min_error_statement flag. It is used to mention/tag that the error messages. Setting it to Error value will help to find the error messages appropriately.", "recommended_action": "Ensure that log_min_error_statement flag is set to Error for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-min-error-statement", "link": "https://cloud.google.com/sql/docs/postgres/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712842, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1047}]}]}, {"id": 1429, "name": "6.2.15 Ensure that the 'log_temp_files' database flag for Cloud SQL PostgreSQL instance is set to '0' (on)", "description": "PostgreSQL can create a temporary file for actions such as sorting, hashing and temporary query results when these operations exceed work_mem. The log_temp_files flag controls logging names and the file size when it is deleted. Configuring log_temp_files to 0 causes all temporary file information to be logged, while positive values log only files whose size is greater than or equal to the specified number of kilobytes. A value of -1 disables temporary file information logging.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1048, "cloud": "google", "query": "postgresqlLogTempFiles", "title": "PostgreSQL Log Temp Files", "description": "Ensures SQL instances for PostgreSQL type have log temp files flag enabled.", "more_info": "SQL instance for PostgreSQL databases provides log_temp_files flag. It is used to log the temporary files name and size. It is not enabled by default. Enabling it will make sure to log names and sizes of all the temporary files that were created during any operation(sort, hashes, query_results etc).", "recommended_action": "Ensure that log_temp_files flag is enabled for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-temp-files", "link": "https://cloud.google.com/sql/docs/postgres/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712843, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1048}]}]}, {"id": 1430, "name": "6.2.16 Ensure that the 'log_min_duration_statement' database flag for Cloud SQL PostgreSQL instance is set to '-1' (disabled)", "description": "The log_min_duration_statement flag defines the minimum amount of execution time of a statement in milliseconds where the total duration of the statement is logged. Ensure that log_min_duration_statement is disabled, i.e., a value of -1 is set.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1049, "cloud": "google", "query": "postgresqlLogMinDuration", "title": "PostgreSQL Log Min Duration Statement", "description": "Ensures SQL instances for PostgreSQL type have log min duration statement flag disabled.", "more_info": "SQL instance for PostgreSQL databases provides log_min_duration_statement flag. It is used to log the duration of every completed statement. This should always be disabled as there can be sensitive information as well that should not be recorded in the logs.", "recommended_action": "Ensure that log_min_duration_statement flag is disabled for all PostgreSQL instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/postgresql-log-min-duration-statement", "link": "https://cloud.google.com/sql/docs/postgres/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712844, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1049}]}]}, {"id": 1432, "name": "6.3.2 Ensure that the 'cross db ownership chaining' database flag for Cloud SQL SQL Server instance is set to 'off'", "description": "It is recommended to set cross db ownership chaining database flag for Cloud SQL SQL Server instance to off.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1051, "cloud": "google", "query": "sqlCrossDbOwnership", "title": "SQL Cross DB Ownership Chaining", "description": "Ensures SQL database instances of SQL Server type have cross db ownership chaining flag disabled.", "more_info": "SQL databases of SQL Server provide cross DB ownership chaining flag. It is used to configure cross-database ownership chaining for all databases. It is enabled by default and should be disabled for security unless all required.", "recommended_action": "Ensure that cross DB ownership chaining flag is disabled for all SQLServer instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/sql-cross-db-ownership-chaining", "link": "https://cloud.google.com/sql/docs/sqlserver/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712846, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1051}]}]}, {"id": 1437, "name": "6.3.7 Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'", "description": "It is recommended to set contained database authentication database flag for Cloud SQL on the SQL Server instance is set to off.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1052, "cloud": "google", "query": "sqlContainedDatabaseAuth", "title": "SQL Contained Database Authentication", "description": "Ensures SQL instances of SQL Server type have Contained Database Authentication flag disabled.", "more_info": "Enabling Contained Database Authentication flag allows users to connect to the database without authenticating a login at the Database Engine level along with other security threats.", "recommended_action": "Ensure that Contained Database Authentication flag is disabled for all SQL Server instances.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/sql-contained-database-authentication", "link": "https://cloud.google.com/sql/docs/sqlserver/flags", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712847, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1052}]}]}, {"id": 1438, "name": "6.4 Ensure that the Cloud SQL database instance requires all incoming connections to use SSL", "description": "It is recommended to enforce all incoming connections to SQL database instance to use SSL.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 679, "cloud": "google", "query": "dbSSLEnabled", "title": "Database SSL Enabled", "description": "Ensures SQL databases have SSL enabled", "more_info": "Enabling SSL ensures that the sensitive data being transferred from the database is encrypted.", "recommended_action": "Ensure that SSL is enabled on all SQL databases.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/database-ssl-enabled/", "link": "https://cloud.google.com/sql/docs/mysql/instance-settings", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712795, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 679}]}]}, {"id": 1439, "name": "6.5 Ensure that Cloud SQL database instances are not open to the world", "description": "Database Server should accept connections only from trusted Network(s)/IP(s) and restrict access from the world.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 470, "cloud": "google", "query": "dbPubliclyAccessible", "title": "DB Publicly Accessible", "description": "Ensures that SQL instances do not allow public access", "more_info": "Unless there is a specific business requirement, SQL instances should not have a public endpoint and should only be accessed from within a VPC.", "recommended_action": "Ensure that SQL instances are configured to prohibit traffic from the public 0.0.0.0 global IP address.", "cs_link": "https://avd.aquasec.com/cspm/google/sql/db-publicly-accessible/", "link": "https://cloud.google.com/sql/docs/mysql/authorize-networks", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712771, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 470}]}]}, {"id": 1440, "name": "6.6 Ensure that Cloud SQL database instances do not have public IPs", "description": "It is recommended to configure Second Generation Sql instance to use private IPs instead of public IPs.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1050, "cloud": "google", "query": "sqlNoPublicIps", "title": "SQL No Public IPs", "description": "Ensure that SQL instances are using private IPs instead of public IPs.", "more_info": "Cloud SQL databases should always use private IP addresses which provide improved network security and lower latency.", "recommended_action": "Make sure that SQL databases IP addresses setting does not have IP address of PRIMARY type", "cs_link": "https://avd.aquasec.com/cspm/google/sql/sql-no-public-ips", "link": "https://cloud.google.com/sql/docs/mysql/configure-private-ip", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 126, "account_id": null, "test_domain_id": 1, "results": [{"id": 21037712845, "result": 0, "resource": null, "message": "Service is not enabled", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T11:12:35.000Z", "scan_id": 7626901, "test_id": 1050}]}]}, {"id": 1442, "name": "7.1 Ensure that BigQuery datasets are not anonymously or publicly accessible", "description": "It is recommended that the IAM policy on BigQuery datasets does not allow anonymous and/or public access.", "program_id": 456, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1089, "cloud": "google", "query": "datasetAllUsersPolicy", "title": "Dataset All Users Policy", "description": "Ensure that BigQuery datasets do not allow public read, write or delete access.", "more_info": "Granting permissions to allUsers or allAuthenticatedUsers allows anyone to access the dataset. Such access might not be desirable if sensitive data is being stored in the dataset.", "recommended_action": "Ensure that each dataset is configured so that no member is set to allUsers or allAuthenticatedUsers.", "cs_link": "https://avd.aquasec.com/cspm/google/bigquery/dataset-all-users-policy", "link": "https://cloud.google.com/bigquery/docs/dataset-access-controls", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 195, "account_id": null, "test_domain_id": 1, "results": []}]}]}