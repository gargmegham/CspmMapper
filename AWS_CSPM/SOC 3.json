{"status": 200, "code": 0, "data": [{"id": 697, "name": "Control Environment: The organization holds individuals accountable for their internal control responsibilities in the pursuit of objectives.", "description": "Enforces accountability through structures, authorities, and responsibilities.", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 302, "cloud": "aws", "query": "iamUserAdmins", "title": "IAM User Admins", "description": "Ensures the number of IAM admins in the account are minimized", "more_info": "While at least two IAM admin users should be configured, the total number of admins should be kept to a minimum.", "recommended_action": "Keep two users with admin permissions but ensure other IAM users have more limited permissions.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-user-admins/", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/getting-started_create-admin-group.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427978, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 302}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 536, "cloud": "aws", "query": "iamRolePolicies", "title": "IAM Role Policies", "description": "Ensures IAM role policies are properly scoped with specific permissions", "more_info": "Policies attached to IAM roles should be scoped to least-privileged access and avoid the use of wildcards.", "recommended_action": "Ensure that all IAM roles are scoped to specific services and API calls.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-role-policies/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035428795, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428796, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428797, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428798, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 815, "cloud": "aws", "query": "crossAccountMfaExtIdAccess", "title": "Cross-Account Access External ID and MFA", "description": "Ensures that either MFA or external IDs are used to access AWS roles.", "more_info": "IAM roles should be configured to require either a shared external ID or use an MFA device when assuming the role.", "recommended_action": "Update the IAM role to either require MFA or use an external ID.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/cross-account-access-external-id-and-mfa/", "link": "https://aws.amazon.com/blogs/aws/mfa-protection-for-cross-account-access/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035430397, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3", "message": "Cross-account role requires MFA/external ID for all accounts", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 815}, {"id": 21035430398, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI", "message": "IAM role does not contain cross-account statements", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 815}, {"id": 21035430399, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport", "message": "IAM role does not contain cross-account statements", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 815}, {"id": 21035430400, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor", "message": "IAM role does not contain cross-account statements", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 815}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 836, "cloud": "aws", "query": "appTierIamRole", "title": "App-Tier Launch Configurations IAM Roles", "description": "Ensures that App-Tier Auto Scaling launch configuration is configured to use a customer created IAM role.", "more_info": "App-Tier Auto Scaling launch configuration should have a customer created App-Tier IAM role to provide necessary credentials to access AWS services.", "recommended_action": "Update App-Tier Auto Scaling launch configuration and attach a customer created App-Tier IAM role", "cs_link": "https://avd.aquasec.com/cspm/aws/autoscaling/app-tier-launch-configurations-iam-roles/", "link": "https://docs.aws.amazon.com/autoscaling/ec2/userguide/us-iam-role.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 91, "account_id": null, "test_domain_id": 8, "results": []}]}, {"id": 698, "name": "Risk Assessment: Identifies and analyzes risk", "description": "The organization identifies risks to the achievement of its objectives across the entity and analyzes risks as a basis for determining how the risks should be managed. ", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 699, "name": "Risk Assessment:Identifies and analyzes significant change", "description": "The organization identifies and assesses changes that could significantly impact the system of internal control. ", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 125, "cloud": "aws", "query": "accessKeysLastUsed", "title": "Access Keys Last Used", "description": "Detects access keys that have not been used for a period of time and that should be decommissioned", "more_info": "Having numerous, unused access keys extends the attack surface. Access keys should be removed if they are no longer being used.", "recommended_action": "Log into the IAM portal and remove the offending access key.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/access-keys-last-used", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/ManagingCredentials.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426979, "result": 0, "resource": null, "message": "No users using access keys found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 125}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 792, "cloud": "aws", "query": "iamRoleLastUsed", "title": "IAM Role Last Used", "description": "Ensures IAM roles that have not been used within the given time frame are deleted.", "more_info": "IAM roles that have not been used for a long period may contain old access policies that could allow unintended access to resources if accidentally attached to new services. These roles should be deleted.", "recommended_action": "Delete IAM roles that have not been used within the expected time frame.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-role-last-used/", "link": "https://aws.amazon.com/about-aws/whats-new/2019/11/identify-unused-iam-roles-easily-and-remove-them-confidently-by-using-the-last-used-timestamp/", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035429611, "result": 2, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3", "message": "IAM role: aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3 has not been used", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 792}, {"id": 21035429612, "result": 2, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI", "message": "IAM role: aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI has not been used", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 792}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 841, "cloud": "aws", "query": "iamUserUnauthorizedToEdit", "title": "IAM User Unauthorized to Edit", "description": "Ensures AWS IAM users that are not authorized to edit IAM access policies are decommissioned.", "more_info": "Only authorized IAM users should have permission to edit IAM access policies to prevent any unauthorized requests.", "recommended_action": "Update unauthorized IAM users to remove permissions to edit IAM access policies.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-user-unauthorized-to-edit/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_controlling.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035430567, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 841}]}]}, {"id": 700, "name": "Control Activities: Deploys control activities through policies and procedures", "description": "The organization deploys control activities through policies that establish what is expected and procedures that put policies into action.", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1, "cloud": "aws", "query": "cloudtrailBucketDelete", "title": "CloudTrail Bucket Delete Policy", "description": "Ensures CloudTrail logging bucket has a policy to prevent deletion of logs without an MFA token", "more_info": "To provide additional security, CloudTrail logging buckets should require an MFA token to delete objects", "recommended_action": "Enable MFA delete on the CloudTrail bucket", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-delete-policy", "link": "http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035426578, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426579, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426580, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426581, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426582, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426583, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426584, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426585, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426586, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426587, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426588, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426589, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426590, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426591, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426592, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426593, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426594, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 24, "cloud": "aws", "query": "minPasswordLength", "title": "Minimum Password Length", "description": "Ensures password policy requires a password of at least a minimum number of characters", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Increase the minimum length requirement for the password policy", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/minimum-password-length", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for minimum password length will be set to the value set by the user. Otherwise, it will default to 14.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426954, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 24}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 25, "cloud": "aws", "query": "passwordRequiresSymbols", "title": "Password Requires Symbols", "description": "Ensures password policy requires the use of symbols", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of symbols", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-symbols", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires symbols will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426955, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 25}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 26, "cloud": "aws", "query": "maxPasswordAge", "title": "Maximum Password Age", "description": "Ensures password policy requires passwords to be reset every 180 days", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Descrease the maximum allowed age of passwords for the password policy", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/maximum-password-age", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for maximum password age will be set to the value set by the user. Otherwise, it will default to 179.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426956, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 26}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 27, "cloud": "aws", "query": "passwordReusePrevention", "title": "Password Reuse Prevention", "description": "Ensures password policy prevents previous password reuse", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Increase the minimum previous passwords that can be reused to 24.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-reuse-prevention", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password reuse prevention will be set to the value set by the user. Otherwise, it will default to 24.", "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426957, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 27}]}, {"remediation_apis": ["S3:deleteBucketPolicy"], "realtime_triggers": null, "asl": null, "id": 232, "cloud": "aws", "query": "bucketAllUsersPolicy", "title": "S3 Bucket All Users Policy", "description": "Ensures S3 bucket policies do not allow global write, delete, or read permissions", "more_info": "S3 buckets can be configured to allow the global principal to access the bucket via the bucket policy. This policy should be restricted only to known users or accounts.", "recommended_action": "Remove wildcard principals from the bucket policy statements.", "cs_link": "https://avd.aquasec.com/cspm/aws/s3/s3-bucket-all-users-policy", "link": "https://docs.aws.amazon.com/AmazonS3/latest/dev/using-iam-policies.html", "deep_link": "https://s3.console.aws.amazon.com/s3/home?region=us-east-1#", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": "202201131602", "remediation_description": "Bucket policy will be deleted for affected buckets.", "severity": "medium", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 3, "results": [{"id": 21035426982, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 232}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 243, "cloud": "aws", "query": "passwordExpiration", "title": "Password Expiration", "description": "Ensures password policy enforces a password expiration", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Enable password expiration for the account", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-expiration", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password expiration will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427169, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 243}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 244, "cloud": "aws", "query": "passwordRequiresLowercase", "title": "Password Requires Lowercase", "description": "Ensures password policy requires at least one lowercase letter", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of lowercase letters", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-lowercase", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires lowercase will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427170, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 244}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 245, "cloud": "aws", "query": "passwordRequiresNumbers", "title": "Password Requires Numbers", "description": "Ensures password policy requires the use of numbers", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of numbers", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-numbers", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires numbers will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427171, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 245}]}, {"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 246, "cloud": "aws", "query": "passwordRequiresUppercase", "title": "Password Requires Uppercase", "description": "Ensures password policy requires at least one uppercase letter", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of uppercase letters", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-uppercase", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires uppercase will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427172, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 246}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 248, "cloud": "aws", "query": "noUserIamPolicies", "title": "No User IAM Policies", "description": "Ensures IAM policies are not connected directly to IAM users", "more_info": "To reduce management complexity, IAM permissions should only be assigned to roles and groups. Users can then be added to those groups. Policies should not be applied directly to a user.", "recommended_action": "Create groups with the required policies, move the IAM users to the applicable groups, and then remove the inline and directly attached policies from the IAM user.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/no-user-iam-policies", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#use-groups-for-permissions", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427174, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 248}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 283, "cloud": "aws", "query": "topicPolicies", "title": "SNS Topic Policies", "description": "Ensures SNS topics do not allow global send or subscribe.", "more_info": "SNS policies should not be configured to allow any AWS user to subscribe or send messages. This could result in data leakage or financial DDoS.", "recommended_action": "Adjust the topic policy to only allow authorized AWS users in known accounts to subscribe.", "cs_link": "https://avd.aquasec.com/cspm/aws/sns/sns-topic-policies/", "link": "http://docs.aws.amazon.com/sns/latest/dg/AccessPolicyLanguage.html", "deep_link": "https://console.aws.amazon.com/sns/v2/home?region={region}#/topics", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 87, "account_id": null, "test_domain_id": 10, "results": [{"id": 21035427507, "result": 0, "resource": null, "message": "No SNS topics found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427508, "result": 0, "resource": null, "message": "No SNS topics found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427509, "result": 0, "resource": null, "message": "No SNS topics found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427510, "result": 0, "resource": null, "message": "No SNS topics found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427511, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427512, "result": 0, "resource": null, "message": "No SNS topics found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427513, "result": 0, "resource": null, "message": "No SNS topics found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427514, "result": 0, "resource": null, "message": "No SNS topics found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427515, "result": 0, "resource": null, "message": "No SNS topics found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427516, "result": 0, "resource": null, "message": "No SNS topics found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427517, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427518, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427519, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427520, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427521, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427522, "result": 0, "resource": null, "message": "No SNS topics found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}, {"id": 21035427523, "result": 0, "resource": null, "message": "No SNS topics found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 283}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 303, "cloud": "aws", "query": "sqsCrossAccount", "title": "SQS Cross Account Access", "description": "Ensures SQS policies disallow cross-account access", "more_info": "SQS policies should be carefully restricted to prevent publishing or reading from the queue from unexpected sources. Queue policies can be used to limit these privileges.", "recommended_action": "Update the SQS policy to prevent access from external accounts.", "cs_link": "https://avd.aquasec.com/cspm/aws/sqs/sqs-cross-account-access/", "link": "http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-creating-custom-policies.html", "deep_link": "https://console.aws.amazon.com/sqs/home?region={region}#", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 92, "account_id": null, "test_domain_id": 10, "results": [{"id": 21035427979, "result": 0, "resource": null, "message": "No SQS queues found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427980, "result": 0, "resource": null, "message": "No SQS queues found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427981, "result": 0, "resource": null, "message": "No SQS queues found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427982, "result": 0, "resource": null, "message": "No SQS queues found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427983, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427984, "result": 0, "resource": null, "message": "No SQS queues found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427985, "result": 0, "resource": null, "message": "No SQS queues found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427986, "result": 0, "resource": null, "message": "No SQS queues found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427987, "result": 0, "resource": null, "message": "No SQS queues found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427988, "result": 0, "resource": null, "message": "No SQS queues found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427989, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427990, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427991, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427992, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427993, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427994, "result": 0, "resource": null, "message": "No SQS queues found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}, {"id": 21035427995, "result": 0, "resource": null, "message": "No SQS queues found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 303}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 307, "cloud": "aws", "query": "usersPasswordLastUsed", "title": "Users Password Last Used", "description": "Detects users with password logins that have not been used for a period of time and that should be decommissioned", "more_info": "Having numerous, unused user accounts extends the attack surface. If users do not log into their accounts for more than the defined period of time, the account should be deleted.", "recommended_action": "Delete old user accounts that allow password-based logins and have not been used recently.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/users-password-last-used/", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_admin-change-user.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035428110, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 307}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 319, "cloud": "aws", "query": "kmsKeyPolicy", "title": "KMS Key Policy", "description": "Validates the KMS key policy to ensure least-privilege access.", "more_info": "KMS key policies should be designed to limit the number of users who can perform encrypt and decrypt operations. Each application should use its own key to avoid over exposure.", "recommended_action": "Modify the KMS key policy to remove any wildcards and limit the number of users and roles that can perform encrypt and decrypt operations using the key.", "cs_link": "https://avd.aquasec.com/cspm/aws/kms/kms-key-policy/", "link": "http://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/encryptionKeys/{region}", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 81, "account_id": null, "test_domain_id": 10, "results": [{"id": 21035428164, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428165, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428166, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428167, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428168, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428169, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428170, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428171, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428172, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428173, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428174, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428175, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428176, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428177, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428258, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428259, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}, {"id": 21035428260, "result": 0, "resource": null, "message": "No KMS keys found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 319}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 439, "cloud": "aws", "query": "instanceKeyBasedLogin", "title": "EC2 Instance Key Based Login", "description": "Ensures EC2 instances have associated keys for password-less SSH login", "more_info": "AWS allows EC2 instances to be launched with a specified PEM key for SSH login which should be used instead of user and password login.", "recommended_action": "Ensure each EC2 instance has an associated SSH key and disable password login.", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/ec2-instance-key-based-login/", "link": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html", "deep_link": null, "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": []}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 523, "cloud": "aws", "query": "ecrRepositoryPolicy", "title": "ECR Repository Policy", "description": "Ensures ECR repository policies do not enable global or public access to images", "more_info": "ECR repository policies should limit access to images to known IAM entities and AWS accounts and avoid the use of account-level wildcards.", "recommended_action": "Update the repository policy to limit access to known IAM entities.", "cs_link": "https://avd.aquasec.com/cspm/aws/ecr/ecr-repository-policy/", "link": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/RepositoryPolicyExamples.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 141, "account_id": null, "test_domain_id": 6, "results": [{"id": 21035428778, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428779, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428780, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428781, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428782, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428783, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428784, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428785, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428786, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428787, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428788, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428789, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428790, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428791, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428792, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428793, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}, {"id": 21035428794, "result": 0, "resource": null, "message": "No ECR repositories present", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 523}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 536, "cloud": "aws", "query": "iamRolePolicies", "title": "IAM Role Policies", "description": "Ensures IAM role policies are properly scoped with specific permissions", "more_info": "Policies attached to IAM roles should be scoped to least-privileged access and avoid the use of wildcards.", "recommended_action": "Ensure that all IAM roles are scoped to specific services and API calls.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-role-policies/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035428795, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428796, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428797, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428798, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 606, "cloud": "aws", "query": "usersPasswordAndKeys", "title": "Users Password And Keys", "description": "Detects whether users with a console password are also using access keys", "more_info": "Access keys should only be assigned to machine users and should not be used for accounts that have console password access.", "recommended_action": "Remove access keys from all users with console access.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/users-password-and-keys/", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/ManagingCredentials.html", "deep_link": null, "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": []}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 749, "cloud": "aws", "query": "bucketEnforceEncryption", "title": "S3 Bucket Enforce Object Encryption", "description": "Ensures S3 bucket policies do not allow uploads of unencrypted objects", "more_info": "S3 bucket policies can be configured to block uploads of objects that are not encrypted.", "recommended_action": "Set the S3 bucket policy to deny uploads of unencrypted objects.", "cs_link": "https://avd.aquasec.com/cspm/aws/s3/s3-bucket-enforce-object-encryption/", "link": "https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/", "deep_link": "https://s3.console.aws.amazon.com/s3/home?region=us-east-1", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 3, "results": []}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 804, "cloud": "aws", "query": "groupInlinePolicies", "title": "Group Inline Policies", "description": "Ensures that groups do not have any inline policies", "more_info": "Managed Policies are recommended over inline policies.", "recommended_action": "Remove inline policies attached to groups", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/group-inline-policies/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035430180, "result": 0, "resource": null, "message": "No groups found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 804}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 841, "cloud": "aws", "query": "iamUserUnauthorizedToEdit", "title": "IAM User Unauthorized to Edit", "description": "Ensures AWS IAM users that are not authorized to edit IAM access policies are decommissioned.", "more_info": "Only authorized IAM users should have permission to edit IAM access policies to prevent any unauthorized requests.", "recommended_action": "Update unauthorized IAM users to remove permissions to edit IAM access policies.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-user-unauthorized-to-edit/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_controlling.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035430567, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 841}]}]}, {"id": 702, "name": "Control Activities: The organization internally communicates information, including objectives and responsibilities for internal control, necessary to support the functioning of internal control. ", "description": "Selects relevant method of communication", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 289, "cloud": "aws", "query": "insecureProtocols", "title": "Insecure CloudFront Protocols", "description": "Detects the use of insecure HTTPS SSL/TLS protocols for use with HTTPS traffic between viewers and CloudFront", "more_info": "CloudFront supports SSLv3 and TLSv1 protocols for use with HTTPS traffic, but only TLSv1.1 or higher should be used unless there is a valid business justification to support the older, insecure SSLv3.", "recommended_action": "Ensure that traffic sent between viewers and CloudFront is passed over HTTPS and uses TLSv1.1 or higher.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudfront/insecure-cloudfront-protocols/", "link": "http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html", "deep_link": "https://console.aws.amazon.com/cloudfront/home?region=us-east-1", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 84, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035427640, "result": 0, "resource": null, "message": "No CloudFront distributions found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 289}]}, {"remediation_apis": ["CloudFront:updateDistribution"], "realtime_triggers": ["cloudfront:CreateDistribution", "cloudfront:UpdateDistribution"], "asl": null, "id": 293, "cloud": "aws", "query": "cloudfrontHttpsOnly", "title": "CloudFront HTTPS Only", "description": "Ensures CloudFront distributions are configured to redirect non-HTTPS traffic to HTTPS.", "more_info": "For maximum security, CloudFront distributions can be configured to only accept HTTPS connections or to redirect HTTP connections to HTTPS.", "recommended_action": "Remove HTTP-only listeners from distributions.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudfront/cloudfront-https-only/", "link": "http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudFront.html", "deep_link": "https://console.aws.amazon.com/cloudfront/home?region=us-east-1#", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": "202101041100", "remediation_description": "CloudFront distribution will be configured to only accept HTTPS connections or to redirect HTTP connections to HTTPS.", "severity": "medium", "no_new_risks": false, "category_id": 84, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035427692, "result": 0, "resource": null, "message": "No CloudFront distributions found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 293}]}, {"remediation_apis": ["ELB:deleteLoadBalancerListeners"], "realtime_triggers": ["elasticloadbalancing:CreateLoadBalancerListeners", "elasticloadbalancing:CreateLoadBalancer"], "asl": null, "id": 294, "cloud": "aws", "query": "elbHttpsOnly", "title": "ELB HTTPS Only", "description": "Ensures ELBs are configured to only accept connections on HTTPS ports.", "more_info": "For maximum security, ELBs can be configured to only accept HTTPS connections. Standard HTTP connections  will be blocked. This should only be done if the  client application is configured to query HTTPS  directly and not rely on a redirect from HTTP.", "recommended_action": "Remove non-HTTPS listeners from load balancer.", "cs_link": "https://avd.aquasec.com/cspm/aws/elb/elb-https-only/", "link": "http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-security-policy-options.html", "deep_link": "https://console.aws.amazon.com/ec2/v2/home?region={region}#LoadBalancers:sort=loadBalancerName", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": "202011062139", "remediation_description": "All HTTP Listeners will be deleted", "severity": "low", "no_new_risks": false, "category_id": 85, "account_id": null, "test_domain_id": 9, "results": []}, {"remediation_apis": ["ES:updateElasticsearchDomainConfig"], "realtime_triggers": ["es:CreateElasticsearchDomain", "es:UpdateElasticsearchDomainConfig"], "asl": null, "id": 663, "cloud": "aws", "query": "esHttpsOnly", "title": "ElasticSearch HTTPS Only", "description": "Ensures ElasticSearch domains are configured to enforce HTTPS connections", "more_info": "ElasticSearch domains should be configured to enforce HTTPS connections for all clients to ensure encryption of data in transit.", "recommended_action": "Ensure HTTPS connections are enforced for all ElasticSearch domains.", "cs_link": "https://avd.aquasec.com/cspm/aws/es/elasticsearch-https-only/", "link": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": "202011271930", "remediation_description": "ES domain will be configured to enforce HTTPS.", "severity": "medium", "no_new_risks": false, "category_id": 167, "account_id": null, "test_domain_id": 1, "results": [{"id": 21035428965, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428966, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428967, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428968, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428969, "result": 0, "resource": null, "message": "No ES domains found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428970, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428971, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428972, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428973, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428974, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428975, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428976, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035428977, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035429058, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035429059, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035429060, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}, {"id": 21035429061, "result": 0, "resource": null, "message": "No ES domains found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 663}]}, {"remediation_apis": ["ELBv2:deleteListener"], "realtime_triggers": ["elasticloadbalancing:CreateListener", "elasticloadbalancing:CreateLoadBalancer"], "asl": null, "id": 761, "cloud": "aws", "query": "elbv2HttpsOnly", "title": "ELBv2 HTTPS Only", "description": "Ensures ELBs are configured to only accept connections on HTTPS ports.", "more_info": "For maximum security, ELBs can be configured to only accept HTTPS connections. Standard HTTP connections  will be blocked. This should only be done if the  client application is configured to query HTTPS  directly and not rely on a redirect from HTTP.", "recommended_action": "Remove non-HTTPS listeners from load balancer.", "cs_link": "https://avd.aquasec.com/cspm/aws/elbv2/elbv2-https-only/", "link": "http://docs.aws.amazon.com/ElasticLoadBalancing/latest/DeveloperGuide/elb-security-policy-options.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": "202011062139", "remediation_description": "All HTTP Listeners will be deleted", "severity": "low", "no_new_risks": false, "category_id": 173, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035429263, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429264, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429265, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429266, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429267, "result": 0, "resource": null, "message": "No load balancers present", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429268, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429269, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429270, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429271, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429272, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429273, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429274, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429275, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429276, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429277, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429278, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}, {"id": 21035429279, "result": 0, "resource": null, "message": "No load balancers present", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 761}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 817, "cloud": "aws", "query": "bucketSecureTransportEnabled", "title": "S3 Secure Transport Enabled", "description": "Ensure AWS S3 buckets enforce SSL to secure data in transit", "more_info": "S3 buckets should be configured to strictly require SSL connections to deny unencrypted HTTP requests when dealing with sensitive data.", "recommended_action": "Update S3 bucket policy to enforse SSL to secure data in transit.", "cs_link": "https://avd.aquasec.com/cspm/aws/s3/s3-secure-transport-enabled/", "link": "https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/", "deep_link": "https://s3.console.aws.amazon.com/s3/home?region=us-east-1", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 3, "results": [{"id": 21035430401, "result": 0, "resource": null, "message": "No S3 buckets found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 817}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 849, "cloud": "aws", "query": "redshiftSSLEnabled", "title": "Redshift Parameter Group SSL Required", "description": "Ensures AWS Redshift non-default parameter group associated with Redshift cluster require SSL connection.", "more_info": "Redshift parameter group associated with Redshift cluster should be configured to require SSL to secure data in transit.", "recommended_action": "Update Redshift parameter groups to have require-ssl parameter set to true.", "cs_link": "https://avd.aquasec.com/cspm/aws/redshift/redshift-parameter-group-ssl-required/", "link": "https://docs.aws.amazon.com/redshift/latest/mgmt/connecting-ssl-support.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 90, "account_id": null, "test_domain_id": 1, "results": [{"id": 21035430830, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430831, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430832, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430833, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430834, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430835, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430836, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430837, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430838, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430839, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430840, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430841, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430842, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430843, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430844, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430845, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}, {"id": 21035430846, "result": 0, "resource": null, "message": "No Redshift clusters found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 849}]}]}, {"id": 703, "name": "Control Activities: Selects and develops control activities", "description": "The organization selects and develops control activities that contribute to the mitigation of risks to the achievement of objectives to acceptable levels. ", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 1, "cloud": "aws", "query": "cloudtrailBucketDelete", "title": "CloudTrail Bucket Delete Policy", "description": "Ensures CloudTrail logging bucket has a policy to prevent deletion of logs without an MFA token", "more_info": "To provide additional security, CloudTrail logging buckets should require an MFA token to delete objects", "recommended_action": "Enable MFA delete on the CloudTrail bucket", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-delete-policy", "link": "http://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035426578, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426579, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426580, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426581, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426582, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426583, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426584, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426585, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426586, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426587, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426588, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426589, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426590, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426591, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426592, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426593, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}, {"id": 21035426594, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 1}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 249, "cloud": "aws", "query": "cloudtrailToCloudwatch", "title": "CloudTrail To CloudWatch", "description": "Ensures CloudTrail logs are being properly delivered to CloudWatch", "more_info": "Sending CloudTrail logs to CloudWatch enables easy integration with AWS CloudWatch alerts, as well as an additional backup log storage location.", "recommended_action": "Enable CloudTrail CloudWatch integration for all regions", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-to-cloudwatch", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427175, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427176, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427177, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427178, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427179, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427180, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427181, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427182, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427183, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427184, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427185, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427186, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427187, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427188, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427189, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427190, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427191, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 251, "cloud": "aws", "query": "cloudtrailBucketAccessLogging", "title": "CloudTrail Bucket Access Logging", "description": "Ensures CloudTrail logging bucket has access logging enabled to detect tampering of log files", "more_info": "CloudTrail buckets should utilize access logging for an additional layer of auditing. If the log files are deleted or modified in any way, the additional access logs can help determine who made the changes.", "recommended_action": "Enable access logging on the CloudTrail bucket from the S3 console", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-access-logging", "link": "http://docs.aws.amazon.com/AmazonS3/latest/UG/ManagingBucketLogging.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427210, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427211, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427212, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427213, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427214, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427215, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427216, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427217, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427298, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427299, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427300, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427301, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427302, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427303, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427304, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427305, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427306, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}]}, {"remediation_apis": ["CloudTrail:updateTrail"], "realtime_triggers": ["cloudtrail:CreateTrail", "cloudtrail:UpdateTrail"], "asl": null, "id": 252, "cloud": "aws", "query": "cloudtrailEncryption", "title": "CloudTrail Encryption", "description": "Ensures CloudTrail encryption at rest is enabled for logs", "more_info": "CloudTrail log files contain sensitive information about an account and should be encrypted at rest for additional protection.", "recommended_action": "Enable CloudTrail log encryption through the CloudTrail console or API", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-encryption", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202010302230", "remediation_description": "Encryption for the affected Cloud trails will be enabled.", "severity": "medium", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427307, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427308, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427309, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427310, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427311, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427312, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427313, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427314, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427315, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427316, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427317, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427318, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427319, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427320, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427321, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427322, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427323, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 253, "cloud": "aws", "query": "cloudtrailBucketPrivate", "title": "CloudTrail Bucket Private", "description": "Ensures CloudTrail logging bucket is not publicly accessible", "more_info": "CloudTrail buckets contain large amounts of sensitive account data and should only be accessible by logged in users.", "recommended_action": "Set the S3 bucket access policy for all CloudTrail buckets to only allow known users to access its files.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-private", "link": "http://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427324, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427325, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427326, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427327, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427328, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427329, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427330, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427331, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427332, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427333, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427334, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427335, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427336, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427337, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427338, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427339, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427340, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 254, "cloud": "aws", "query": "flowLogsEnabled", "title": "VPC Flow Logs Enabled", "description": "Ensures VPC flow logs are enabled for traffic logging", "more_info": "VPC flow logs record all traffic flowing in to and out of a VPC. These logs are critical for auditing and review after security incidents.", "recommended_action": "Enable VPC flow logs for each VPC", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/vpc-flow-logs-enabled", "link": "http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html", "deep_link": "https://console.aws.amazon.com/vpc/home?region={region}#vpcs:", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035427341, "result": 2, "resource": "arn:aws:ec2:us-east-1:824888891866:vpc/vpc-0a3f4e1834152c63e", "message": "VPC flow logs are not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427342, "result": 2, "resource": "arn:aws:ec2:us-east-2:824888891866:vpc/vpc-0d5a598b0b6ae09dc", "message": "VPC flow logs are not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427343, "result": 2, "resource": "arn:aws:ec2:us-west-1:824888891866:vpc/vpc-044982e7fb47846b4", "message": "VPC flow logs are not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427344, "result": 2, "resource": "arn:aws:ec2:us-west-2:824888891866:vpc/vpc-0dad837d21c887068", "message": "VPC flow logs are not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427345, "result": 2, "resource": "arn:aws:ec2:ca-central-1:824888891866:vpc/vpc-0bb5f7bc67399cd02", "message": "VPC flow logs are not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427346, "result": 2, "resource": "arn:aws:ec2:eu-central-1:824888891866:vpc/vpc-0e022b4f23827763b", "message": "VPC flow logs are not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427347, "result": 2, "resource": "arn:aws:ec2:eu-west-1:824888891866:vpc/vpc-0a5696625afbb9280", "message": "VPC flow logs are not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427348, "result": 2, "resource": "arn:aws:ec2:eu-west-2:824888891866:vpc/vpc-029b7daf421fd3f86", "message": "VPC flow logs are not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427349, "result": 2, "resource": "arn:aws:ec2:eu-west-3:824888891866:vpc/vpc-01d970672e4d42512", "message": "VPC flow logs are not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427350, "result": 2, "resource": "arn:aws:ec2:eu-north-1:824888891866:vpc/vpc-02ba4054988a5d600", "message": "VPC flow logs are not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427351, "result": 2, "resource": "arn:aws:ec2:ap-northeast-1:824888891866:vpc/vpc-0f89a6a6acce1d799", "message": "VPC flow logs are not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427352, "result": 2, "resource": "arn:aws:ec2:ap-northeast-2:824888891866:vpc/vpc-097002f7760064366", "message": "VPC flow logs are not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427353, "result": 2, "resource": "arn:aws:ec2:ap-southeast-1:824888891866:vpc/vpc-08a2ca016e3520c2e", "message": "VPC flow logs are not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427354, "result": 2, "resource": "arn:aws:ec2:ap-southeast-2:824888891866:vpc/vpc-0f3f8c1abfe1e0218", "message": "VPC flow logs are not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427355, "result": 2, "resource": "arn:aws:ec2:ap-northeast-3:824888891866:vpc/vpc-039148ffa7d69e6d0", "message": "VPC flow logs are not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427356, "result": 2, "resource": "arn:aws:ec2:ap-south-1:824888891866:vpc/vpc-0a1877810bbb220db", "message": "VPC flow logs are not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427357, "result": 2, "resource": "arn:aws:ec2:sa-east-1:824888891866:vpc/vpc-074363bb0c60c3b06", "message": "VPC flow logs are not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 295, "cloud": "aws", "query": "elbLoggingEnabled", "title": "ELB Logging Enabled", "description": "Ensures load balancers have request logging enabled.", "more_info": "Logging requests to ELB endpoints is a helpful way of detecting and investigating potential attacks, malicious activity, or misuse of backend resources.Logs can be sent to S3 and processed for further analysis.", "recommended_action": "Enable ELB request logging", "cs_link": "https://avd.aquasec.com/cspm/aws/elb/elb-logging-enabled/", "link": "http://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html", "deep_link": "https://console.aws.amazon.com/ec2/v2/home?region={region}#LoadBalancers:sort=loadBalancerName", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 85, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035427693, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427694, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427695, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427696, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427697, "result": 0, "resource": null, "message": "No load balancers present", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427778, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427779, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427780, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427781, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427782, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427783, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427784, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427785, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427786, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427787, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427788, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}, {"id": 21035427789, "result": 0, "resource": null, "message": "No load balancers present", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 295}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 298, "cloud": "aws", "query": "cloudfrontLoggingEnabled", "title": "CloudFront Logging Enabled", "description": "Ensures CloudFront distributions have request logging enabled.", "more_info": "Logging requests to CloudFront distributions is a helpful way of detecting and investigating potential attacks, malicious activity, or misuse of backend resources. Logs can be sent to S3 and processed for further analysis.", "recommended_action": "Enable CloudFront request logging.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudfront/cloudfront-logging-enabled/", "link": "http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html", "deep_link": "https://console.aws.amazon.com/cloudfront/home?region=us-east-1#", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 84, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035427824, "result": 0, "resource": null, "message": "No CloudFront distributions found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 298}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 310, "cloud": "aws", "query": "bucketLogging", "title": "S3 Bucket Logging", "description": "Ensures S3 bucket logging is enabled for S3 buckets", "more_info": "S3 bucket logging helps maintain an audit trail of                 access that can be used in the event of a security                 incident.", "recommended_action": "Enable bucket logging for each S3 bucket.", "cs_link": "https://avd.aquasec.com/cspm/aws/s3/s3-bucket-logging/", "link": "http://docs.aws.amazon.com/AmazonS3/latest/dev/Logging.html", "deep_link": "https://s3.console.aws.amazon.com/s3/home?region=us-east-1", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 3, "results": [{"id": 21035428128, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 310}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 344, "cloud": "aws", "query": "transferLoggingEnabled", "title": "Transfer Logging Enabled", "description": "Ensures AWS Transfer servers have CloudWatch logging enabled.", "more_info": "AWS Transfer servers can log activity to CloudWatch if a proper IAM service role is provided. This role should be configured for all servers to ensure proper access logging.", "recommended_action": "Provide a valid IAM service role for AWS Transfer servers.", "cs_link": "https://avd.aquasec.com/cspm/aws/transfer/transfer-logging-enabled/", "link": "https://docs.aws.amazon.com/transfer/latest/userguide/monitoring.html", "deep_link": "https://console.aws.amazon.com/transfer/home?region={region}#/servers", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 105, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035428427, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428428, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428429, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428430, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428431, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428432, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428433, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428434, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428435, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428436, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428437, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428438, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428439, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428440, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428441, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428442, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}, {"id": 21035428443, "result": 0, "resource": null, "message": "No Transfer servers found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 344}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 372, "cloud": "aws", "query": "rdsLoggingEnabled", "title": "RDS Logging Enabled", "description": "Ensures logging is configured for RDS instances", "more_info": "Logging database level events enables teams to analyze events for the purpose diagnostics as well as audit tracking for compliance purposes.", "recommended_action": "Modify the RDS instance to enable logging as required.", "cs_link": "https://avd.aquasec.com/cspm/aws/rds/rds-logging-enabled/", "link": "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_LogAccess.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 79, "account_id": null, "test_domain_id": 1, "results": [{"id": 21035428495, "result": 0, "resource": null, "message": "No RDS instances found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428496, "result": 0, "resource": null, "message": "No RDS instances found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428497, "result": 0, "resource": null, "message": "No RDS instances found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428578, "result": 0, "resource": null, "message": "No RDS instances found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428579, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428580, "result": 0, "resource": null, "message": "No RDS instances found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428581, "result": 0, "resource": null, "message": "No RDS instances found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428582, "result": 0, "resource": null, "message": "No RDS instances found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428583, "result": 0, "resource": null, "message": "No RDS instances found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428584, "result": 0, "resource": null, "message": "No RDS instances found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428585, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428586, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428587, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428588, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428589, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428590, "result": 0, "resource": null, "message": "No RDS instances found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}, {"id": 21035428591, "result": 0, "resource": null, "message": "No RDS instances found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 372}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 439, "cloud": "aws", "query": "instanceKeyBasedLogin", "title": "EC2 Instance Key Based Login", "description": "Ensures EC2 instances have associated keys for password-less SSH login", "more_info": "AWS allows EC2 instances to be launched with a specified PEM key for SSH login which should be used instead of user and password login.", "recommended_action": "Ensure each EC2 instance has an associated SSH key and disable password login.", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/ec2-instance-key-based-login/", "link": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html", "deep_link": null, "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": []}, {"remediation_apis": ["EKS:updateClusterConfig"], "realtime_triggers": null, "asl": null, "id": 513, "cloud": "aws", "query": "eksLoggingEnabled", "title": "EKS Logging Enabled", "description": "Ensures all EKS cluster logs are being sent to CloudWatch", "more_info": "EKS supports routing of cluster event and audit logs to CloudWatch, including control plane logs. All logs should be sent to CloudWatch for security analysis.", "recommended_action": "Enable all EKS cluster logs to be sent to CloudWatch with proper log retention limits.", "cs_link": "https://avd.aquasec.com/cspm/aws/eks/eks-logging-enabled/", "link": "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "EKS logging will be enabled for all supported services.", "severity": "low", "no_new_risks": false, "category_id": 139, "account_id": null, "test_domain_id": 6, "results": [{"id": 21035428647, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428648, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428649, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428650, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428651, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428652, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428653, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428654, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428655, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428656, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428657, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428738, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428739, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428740, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428741, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428742, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}, {"id": 21035428743, "result": 0, "resource": null, "message": "No EKS clusters present", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 513}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 661, "cloud": "aws", "query": "esLoggingEnabled", "title": "ElasticSearch Logging Enabled", "description": "Ensures ElasticSearch domains are configured to log data to CloudWatch", "more_info": "ElasticSearch domains should be configured with logging enabled with logs sent to CloudWatch for analysis and long-term storage.", "recommended_action": "Ensure logging is enabled and a CloudWatch log group is specified for each ElasticSearch domain.", "cs_link": "https://avd.aquasec.com/cspm/aws/es/elasticsearch-logging-enabled/", "link": "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html#es-createdomain-configure-slow-logs", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 167, "account_id": null, "test_domain_id": 1, "results": [{"id": 21035428931, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428932, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428933, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428934, "result": 0, "resource": null, "message": "No ES domains found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428935, "result": 0, "resource": null, "message": "No ES domains found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428936, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428937, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428938, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428939, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428940, "result": 0, "resource": null, "message": "No ES domains found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428941, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428942, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428943, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428944, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428945, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428946, "result": 0, "resource": null, "message": "No ES domains found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}, {"id": 21035428947, "result": 0, "resource": null, "message": "No ES domains found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 661}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 760, "cloud": "aws", "query": "elbv2LoggingEnabled", "title": "ELBv2 Logging Enabled", "description": "Ensures load balancers have request logging enabled.", "more_info": "Logging requests to ELB endpoints is a helpful way of detecting and investigating potential attacks, malicious activity, or misuse of backend resources.Logs can be sent to S3 and processed for further analysis.", "recommended_action": "Enable ELB request logging", "cs_link": "https://avd.aquasec.com/cspm/aws/elbv2/elbv2-logging-enabled/", "link": "http://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 173, "account_id": null, "test_domain_id": 9, "results": [{"id": 21035429246, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429247, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429248, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429249, "result": 0, "resource": null, "message": "No load balancers present", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429250, "result": 0, "resource": null, "message": "No load balancers present", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429251, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429252, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429253, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429254, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429255, "result": 0, "resource": null, "message": "No load balancers present", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429256, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429257, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429258, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429259, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429260, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429261, "result": 0, "resource": null, "message": "No load balancers present", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}, {"id": 21035429262, "result": 0, "resource": null, "message": "No load balancers present", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 760}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 785, "cloud": "aws", "query": "lambdaLogGroups", "title": "Lambda Log Groups", "description": "Ensures each Lambda function has a valid log group attached to it", "more_info": "Every Lambda function created should automatically have a CloudWatch log group generated to handle its log streams.", "recommended_action": "Update the Lambda function permissions to allow CloudWatch logging.", "cs_link": "https://avd.aquasec.com/cspm/aws/lambda/lambda-log-groups/", "link": "https://docs.aws.amazon.com/lambda/latest/dg/monitoring-cloudwatchlogs.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 89, "account_id": null, "test_domain_id": 4, "results": [{"id": 21035429542, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429543, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429544, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429545, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429546, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429547, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429548, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429549, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429550, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429551, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429552, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429553, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429554, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429555, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429556, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429557, "result": 0, "resource": "arn:aws:lambda:ap-south-1:824888891866:function:aqua-cspm-security-scanne-GenerateCSPMExternalIdFu-ggidOGLZsDA9", "message": "Function has log group: /aws/lambda/aqua-cspm-security-scanne-GenerateCSPMExternalIdFu-ggidOGLZsDA9", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429558, "result": 0, "resource": "arn:aws:lambda:ap-south-1:824888891866:function:aqua-cspm-security-scanner-CreateCSPMKeyFunction-OaOj5bMYFlBd", "message": "Function has log group: /aws/lambda/aqua-cspm-security-scanner-CreateCSPMKeyFunction-OaOj5bMYFlBd", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}, {"id": 21035429559, "result": 0, "resource": null, "message": "No Lambda functions found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 785}]}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 832, "cloud": "aws", "query": "appTierAsgCloudwatchLogs", "title": "App-Tier Auto Scaling Group CloudWatch Logs Enabled", "description": "Ensures that App-Tier Auto Scaling Groups are using CloudWatch logs agent.", "more_info": "EC2 instance available within app-tier Auto Scaling Group (ASG) should use an AWS CloudWatch Logs agent to monitor, store and access log files.", "recommended_action": "Update app-tier Auto Scaling Group to use CloudWatch Logs agent", "cs_link": "https://avd.aquasec.com/cspm/aws/autoscaling/app-tier-auto-scaling-group-cloudwatch-logs-enabled/", "link": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Install-CloudWatch-Agent.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 91, "account_id": null, "test_domain_id": 8, "results": []}, {"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 833, "cloud": "aws", "query": "webTierAsgCloudwatchLogs", "title": "Web-Tier Auto Scaling Group CloudWatch Logs Enabled", "description": "Ensures that Web-Tier Auto Scaling Groups are using CloudWatch Logs agent.", "more_info": "EC2 instance available within web-tier Auto Scaling Group (ASG) should use an AWS CloudWatch Logs agent to monitor, store and access log files.", "recommended_action": "Update web-tier Auto Scaling Group to use CloudWatch Logs agent", "cs_link": "https://avd.aquasec.com/cspm/aws/autoscaling/web-tier-auto-scaling-group-cloudwatch-logs-enabled/", "link": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Install-CloudWatch-Agent.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 91, "account_id": null, "test_domain_id": 8, "results": []}]}, {"id": 705, "name": "Monitoring Activities: Conducts ongoing and/or separate evaluations", "description": "Monitoring activities are periodic or ongoing evaluations to verify that each of internal control, are present and functioning around their products. ", "program_id": 308, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}]}