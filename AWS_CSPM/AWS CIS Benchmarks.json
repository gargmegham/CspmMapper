{"status": 200, "code": 0, "data": [{"id": 62, "name": "1.1 Avoid the Use of the Root Account", "description": "The \"root\" account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 247, "cloud": "aws", "query": "rootAccountInUse", "title": "Root Account In Use", "description": "Ensures the root account is not being actively used", "more_info": "The root account should not be used for day-to-day account management. IAM users, roles, and groups should be used instead.", "recommended_action": "Create IAM users with appropriate group-level permissions for account access. Create an MFA token for the root account, and store its password and token generation QR codes in a secure place.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/root-account-in-use", "link": "http://docs.aws.amazon.com/general/latest/gr/root-vs-iam.html", "deep_link": "https://console.aws.amazon.com/billing/home?#/account", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427173, "result": 2, "resource": "arn:aws:iam::824888891866:root", "message": "Root account was last used 0 days ago", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 247}]}]}, {"id": 63, "name": "1.2 Ensure Multi-Factor Authentication (MFA) is Enabled for All IAM Users that Have a Console Password", "description": "Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 30, "cloud": "aws", "query": "usersMfaEnabled", "title": "Users MFA Enabled", "description": "Ensures a multi-factor authentication device is enabled for all users within the account", "more_info": "User accounts should have an MFA device setup to enable two-factor authentication", "recommended_action": "Enable an MFA device for the user account", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/users-mfa-enabled", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426960, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 30}]}]}, {"id": 64, "name": "1.3 Ensure Credentials Unused for 90 Days or Greater are Disabled", "description": "AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 90 or greater days be removed or deactivated.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 125, "cloud": "aws", "query": "accessKeysLastUsed", "title": "Access Keys Last Used", "description": "Detects access keys that have not been used for a period of time and that should be decommissioned", "more_info": "Having numerous, unused access keys extends the attack surface. Access keys should be removed if they are no longer being used.", "recommended_action": "Log into the IAM portal and remove the offending access key.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/access-keys-last-used", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/ManagingCredentials.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426979, "result": 0, "resource": null, "message": "No users using access keys found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 125}]}]}, {"id": 65, "name": "1.4 Ensure Access Keys are Rotated Every 90 Days or Less", "description": "Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 124, "cloud": "aws", "query": "accessKeysRotated", "title": "Access Keys Rotated", "description": "Ensures access keys are not older than 180 days in order to reduce accidental exposures", "more_info": "Access keys should be rotated frequently to avoid having them accidentally exposed.", "recommended_action": "To rotate an access key, first create a new key, replace the key and secret throughout your app or scripts, then set the previous key to disabled. Once you ensure that no services are broken, then fully delete the old key.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/access-keys-rotated", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/ManagingCredentials.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426978, "result": 0, "resource": null, "message": "No IAM user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 124}]}]}, {"id": 66, "name": "1.5 Ensure IAM Password Policy Requires at Least One Uppercase Letter", "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 246, "cloud": "aws", "query": "passwordRequiresUppercase", "title": "Password Requires Uppercase", "description": "Ensures password policy requires at least one uppercase letter", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of uppercase letters", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-uppercase", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires uppercase will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427172, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 246}]}]}, {"id": 67, "name": "1.6 Ensure IAM Password Policy Requires at Least One Lowercase Letter ", "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 244, "cloud": "aws", "query": "passwordRequiresLowercase", "title": "Password Requires Lowercase", "description": "Ensures password policy requires at least one lowercase letter", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of lowercase letters", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-lowercase", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires lowercase will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427170, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 244}]}]}, {"id": 68, "name": "1.7 Ensure IAM Password Policy Requires at Least One Symbol", "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 25, "cloud": "aws", "query": "passwordRequiresSymbols", "title": "Password Requires Symbols", "description": "Ensures password policy requires the use of symbols", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of symbols", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-symbols", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires symbols will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426955, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 25}]}]}, {"id": 69, "name": "1.8 Ensure IAM Password Policy Requires at Least One Number", "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 245, "cloud": "aws", "query": "passwordRequiresNumbers", "title": "Password Requires Numbers", "description": "Ensures password policy requires the use of numbers", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Update the password policy to require the use of numbers", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-requires-numbers", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password requires numbers will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427171, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 245}]}]}, {"id": 70, "name": "1.9 Ensure IAM Password Policy requires Minimum Length of 14 or Greater", "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 24, "cloud": "aws", "query": "minPasswordLength", "title": "Minimum Password Length", "description": "Ensures password policy requires a password of at least a minimum number of characters", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Increase the minimum length requirement for the password policy", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/minimum-password-length", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for minimum password length will be set to the value set by the user. Otherwise, it will default to 14.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426954, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 24}]}]}, {"id": 71, "name": "1.10 Ensure IAM Password Policy Prevents Password Reuse", "description": "IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 27, "cloud": "aws", "query": "passwordReusePrevention", "title": "Password Reuse Prevention", "description": "Ensures password policy prevents previous password reuse", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Increase the minimum previous passwords that can be reused to 24.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-reuse-prevention", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password reuse prevention will be set to the value set by the user. Otherwise, it will default to 24.", "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426957, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 27}]}]}, {"id": 72, "name": "1.11 Ensure IAM Password Policy Expires Passwords Within 90 Days or Less", "description": "IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.", "program_id": 22, "tests": [{"remediation_apis": ["IAM:updateAccountPasswordPolicy"], "realtime_triggers": null, "asl": null, "id": 243, "cloud": "aws", "query": "passwordExpiration", "title": "Password Expiration", "description": "Ensures password policy enforces a password expiration", "more_info": "A strong password policy enforces minimum length, expirations, reuse, and symbol usage", "recommended_action": "Enable password expiration for the account", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/password-expiration", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/Using_ManagingPasswordPolicies.html", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/account_settings", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006221808", "remediation_description": "The password policy for password expiration will be set to true.", "severity": "medium", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427169, "result": 2, "resource": null, "message": "Account does not have a password policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 243}]}]}, {"id": 73, "name": "1.12 Ensure no Root Account Access Key Exists", "description": "The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 29, "cloud": "aws", "query": "rootAccessKeys", "title": "Root Access Keys", "description": "Ensures the root account is not using access keys", "more_info": "The root account should avoid using access keys. Since the root account has full permissions across the entire account, creating access keys for it only increases the chance that they are compromised. Instead, create IAM users with predefined roles.", "recommended_action": "Remove access keys for the root account and setup IAM users with limited permissions instead", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/root-access-keys", "link": "http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html", "deep_link": "https://console.aws.amazon.com/billing/home?#/account", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426959, "result": 0, "resource": "arn:aws:iam::824888891866:root", "message": "Access keys were not found for the root account", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 29}]}]}, {"id": 74, "name": "1.13 Ensure MFA is Enabled for the Root Account", "description": "The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 28, "cloud": "aws", "query": "rootMfaEnabled", "title": "Root MFA Enabled", "description": "Ensures a multi-factor authentication device is enabled for the root account", "more_info": "The root account should have an MFA device setup to enable two-factor authentication.", "recommended_action": "Enable an MFA device for the root account and then use an IAM user for managing services", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/root-mfa-enabled", "link": "http://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html", "deep_link": "https://console.aws.amazon.com/billing/home?#/account", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035426958, "result": 2, "resource": "arn:aws:iam::824888891866:root", "message": "An MFA device was not found for the root account", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 28}]}]}, {"id": 75, "name": "1.14 Ensure Hardware MFA is Enabled for the Root Account", "description": "The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 608, "cloud": "aws", "query": "rootHardwareMfa", "title": "Root Hardware MFA", "description": "Ensures the root account is using a hardware MFA device", "more_info": "The root account should use a hardware MFA device for added security, rather than a virtual device which could be more easily compromised.", "recommended_action": "Enable a hardware MFA device for the root account and disable any virtual devices", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/root-hardware-mfa/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_physical.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": []}]}, {"id": 77, "name": "1.16 Ensure IAM Policies are Attached Only to Groups or Roles", "description": "By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 248, "cloud": "aws", "query": "noUserIamPolicies", "title": "No User IAM Policies", "description": "Ensures IAM policies are not connected directly to IAM users", "more_info": "To reduce management complexity, IAM permissions should only be assigned to roles and groups. Users can then be added to those groups. Policies should not be applied directly to a user.", "recommended_action": "Create groups with the required policies, move the IAM users to the applicable groups, and then remove the inline and directly attached policies from the IAM user.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/no-user-iam-policies", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#use-groups-for-permissions", "deep_link": "https://console.aws.amazon.com/iam/home?region=us-east-1#/users", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035427174, "result": 0, "resource": null, "message": "No user accounts found", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 248}]}]}, {"id": 80, "name": "1.19 Ensure IAM Instance Roles are Used for AWS Resource Access from Instances", "description": "AWS access from within AWS instances can be done by either encoding AWS keys into AWS API calls or by assigning the instance to a role which has an appropriate permissions policy for the required access. \"AWS Access\" means accessing the APIs of AWS in order to access AWS resources or manage AWS account resources.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 290, "cloud": "aws", "query": "instanceIamRole", "title": "Instance IAM Role", "description": "Ensures EC2 instances are using an IAM role instead of hard-coded AWS credentials", "more_info": "IAM roles should be assigned to all instances to enable them to access AWS resources. Using an IAM role is more secure than hard-coding AWS access keys into application code.", "recommended_action": "Attach an IAM role to the EC2 instance", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/instance-iam-role/", "link": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html", "deep_link": "https://console.aws.amazon.com/ec2/v2/home?region={region}#Instances:sort=instanceId", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035427641, "result": 0, "resource": null, "message": "No instances found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427642, "result": 0, "resource": null, "message": "No instances found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427643, "result": 0, "resource": null, "message": "No instances found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427644, "result": 0, "resource": null, "message": "No instances found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427645, "result": 0, "resource": null, "message": "No instances found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427646, "result": 0, "resource": null, "message": "No instances found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427647, "result": 0, "resource": null, "message": "No instances found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427648, "result": 0, "resource": null, "message": "No instances found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427649, "result": 0, "resource": null, "message": "No instances found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427650, "result": 0, "resource": null, "message": "No instances found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427651, "result": 0, "resource": null, "message": "No instances found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427652, "result": 0, "resource": null, "message": "No instances found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427653, "result": 0, "resource": null, "message": "No instances found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427654, "result": 0, "resource": null, "message": "No instances found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427655, "result": 0, "resource": null, "message": "No instances found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427656, "result": 0, "resource": null, "message": "No instances found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}, {"id": 21035427657, "result": 0, "resource": null, "message": "No instances found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 290}]}]}, {"id": 82, "name": "1.21 Do Not Setup Access Keys During Initial User Setup for all IAM Users that Have a Console Password", "description": "AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 606, "cloud": "aws", "query": "usersPasswordAndKeys", "title": "Users Password And Keys", "description": "Detects whether users with a console password are also using access keys", "more_info": "Access keys should only be assigned to machine users and should not be used for accounts that have console password access.", "recommended_action": "Remove access keys from all users with console access.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/users-password-and-keys/", "link": "http://docs.aws.amazon.com/IAM/latest/UserGuide/ManagingCredentials.html", "deep_link": null, "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": []}]}, {"id": 83, "name": "1.22 Ensure IAM Policies That Allow Full \"*:*\" Administrative Privileges are Not Created", "description": "IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege?that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 536, "cloud": "aws", "query": "iamRolePolicies", "title": "IAM Role Policies", "description": "Ensures IAM role policies are properly scoped with specific permissions", "more_info": "Policies attached to IAM roles should be scoped to least-privileged access and avoid the use of wildcards.", "recommended_action": "Ensure that all IAM roles are scoped to specific services and API calls.", "cs_link": "https://avd.aquasec.com/cspm/aws/iam/iam-role-policies/", "link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html", "deep_link": null, "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 6, "account_id": null, "test_domain_id": 2, "results": [{"id": 21035428795, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-AquaCSPMRole-1EJXK17YOUJB3", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428796, "result": 0, "resource": "arn:aws:iam::824888891866:role/aqua-cspm-security-scanner-LambdaExecutionRole-1TWJRL74GAFXI", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428797, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}, {"id": 21035428798, "result": 0, "resource": "arn:aws:iam::824888891866:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor", "message": "Role does not have overly-permissive policy", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 536}]}]}, {"id": 84, "name": "2.1 Ensure CloudTrail is Enabled in All Regions", "description": "AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation).", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 2, "cloud": "aws", "query": "cloudtrailEnabled", "title": "CloudTrail Enabled", "description": "Ensures CloudTrail is enabled for all regions within an account", "more_info": "CloudTrail should be enabled for all regions in order to detect suspicious activity in regions that are not typically used.", "recommended_action": "Enable CloudTrail for all regions and ensure that at least one region monitors global service events", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-enabled", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-getting-started.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035426595, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426596, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426597, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426598, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426599, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426600, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426601, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426602, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426603, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426604, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426605, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426606, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426607, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426608, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426609, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426610, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426611, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}, {"id": 21035426612, "result": 2, "resource": null, "message": "CloudTrail is not configured to monitor global services", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 2}]}]}, {"id": 85, "name": "2.2 Ensure CloudTrail Log File Validation is Enabled", "description": "CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails.", "program_id": 22, "tests": [{"remediation_apis": ["CloudTrail:updateTrail"], "realtime_triggers": ["cloudtrail:CreateTrail", "cloudtrail:UpdateTrail"], "asl": null, "id": 242, "cloud": "aws", "query": "cloudtrailFileValidation", "title": "CloudTrail File Validation", "description": "Ensures CloudTrail file validation is enabled for all regions within an account", "more_info": "CloudTrail file validation is essentially a hash of the file which can be used to ensure its integrity in the case of an account compromise.", "recommended_action": "Enable CloudTrail file validation for all regions", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-file-validation", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202010311808", "remediation_description": "File validation will be enabled for the trail", "severity": "medium", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427152, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427153, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427154, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427155, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427156, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427157, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427158, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427159, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427160, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427161, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427162, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427163, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427164, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427165, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427166, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427167, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}, {"id": 21035427168, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 242}]}]}, {"id": 86, "name": "2.3 Ensure the S3 Bucket Used to Store CloudTrail Logs is Not Publicly Accessible", "description": "CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 253, "cloud": "aws", "query": "cloudtrailBucketPrivate", "title": "CloudTrail Bucket Private", "description": "Ensures CloudTrail logging bucket is not publicly accessible", "more_info": "CloudTrail buckets contain large amounts of sensitive account data and should only be accessible by logged in users.", "recommended_action": "Set the S3 bucket access policy for all CloudTrail buckets to only allow known users to access its files.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-private", "link": "http://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427324, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427325, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427326, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427327, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427328, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427329, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427330, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427331, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427332, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427333, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427334, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427335, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427336, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427337, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427338, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427339, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}, {"id": 21035427340, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 253}]}]}, {"id": 87, "name": "2.4 Ensure CloudTrail Trails are Integrated with CloudWatch Logs ", "description": "AWS CloudTrail is a web service that records AWS API calls made in a given AWS account. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 249, "cloud": "aws", "query": "cloudtrailToCloudwatch", "title": "CloudTrail To CloudWatch", "description": "Ensures CloudTrail logs are being properly delivered to CloudWatch", "more_info": "Sending CloudTrail logs to CloudWatch enables easy integration with AWS CloudWatch alerts, as well as an additional backup log storage location.", "recommended_action": "Enable CloudTrail CloudWatch integration for all regions", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-to-cloudwatch", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427175, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427176, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427177, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427178, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427179, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427180, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427181, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427182, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427183, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427184, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427185, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427186, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427187, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427188, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427189, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427190, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}, {"id": 21035427191, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 249}]}]}, {"id": 88, "name": "2.5 Ensure AWS Config is Enabled in All Regions", "description": "AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. It is recommended to enable AWS Config be enabled in all regions.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 250, "cloud": "aws", "query": "configServiceEnabled", "title": "Config Service Enabled", "description": "Ensures the AWS Config Service is enabled to detect changes to account resources", "more_info": "The AWS Config Service tracks changes to a number of resources in an AWS account and is invaluable in determining how account changes affect other resources and in recovery in the event of an account intrusion or accidental configuration change.", "recommended_action": "Enable the AWS Config Service for all regions and resources in an account. Ensure that it is properly recording and delivering logs.", "cs_link": "https://avd.aquasec.com/cspm/aws/configservice/config-service-enabled", "link": "https://aws.amazon.com/config/details/", "deep_link": "https://console.aws.amazon.com/config/home?region={region}#/configure", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 82, "account_id": null, "test_domain_id": 7, "results": [{"id": 21035427192, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427193, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427194, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427195, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427196, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427197, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427198, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427199, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427200, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427201, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427202, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427203, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427204, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427205, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427206, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427207, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427208, "result": 2, "resource": null, "message": "Config Service is not configured", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}, {"id": 21035427209, "result": 2, "resource": null, "message": "Config Service is not monitoring global services", "region": "global", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 250}]}]}, {"id": 89, "name": "2.6 Ensure S3 Bucket Access Logging is Enabled on the CloudTrail S3 Bucket", "description": "S3 Bucket Access Logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. It is recommended that bucket access logging be enabled on the CloudTrail S3 bucket.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 251, "cloud": "aws", "query": "cloudtrailBucketAccessLogging", "title": "CloudTrail Bucket Access Logging", "description": "Ensures CloudTrail logging bucket has access logging enabled to detect tampering of log files", "more_info": "CloudTrail buckets should utilize access logging for an additional layer of auditing. If the log files are deleted or modified in any way, the additional access logs can help determine who made the changes.", "recommended_action": "Enable access logging on the CloudTrail bucket from the S3 console", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-bucket-access-logging", "link": "http://docs.aws.amazon.com/AmazonS3/latest/UG/ManagingBucketLogging.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "high", "no_new_risks": false, "category_id": 78, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427210, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427211, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427212, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427213, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427214, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427215, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427216, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427217, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427298, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427299, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427300, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427301, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427302, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427303, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427304, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427305, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}, {"id": 21035427306, "result": 0, "resource": null, "message": "No S3 buckets to check", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 251}]}]}, {"id": 90, "name": "2.7 Ensure CloudTrail Logs are Encrypted at Rest Using KMS CMKs", "description": "AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS.", "program_id": 22, "tests": [{"remediation_apis": ["CloudTrail:updateTrail"], "realtime_triggers": ["cloudtrail:CreateTrail", "cloudtrail:UpdateTrail"], "asl": null, "id": 252, "cloud": "aws", "query": "cloudtrailEncryption", "title": "CloudTrail Encryption", "description": "Ensures CloudTrail encryption at rest is enabled for logs", "more_info": "CloudTrail log files contain sensitive information about an account and should be encrypted at rest for additional protection.", "recommended_action": "Enable CloudTrail log encryption through the CloudTrail console or API", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudtrail/cloudtrail-encryption", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html", "deep_link": "https://console.aws.amazon.com/cloudtrail/home?region={region}#/configuration", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202010302230", "remediation_description": "Encryption for the affected Cloud trails will be enabled.", "severity": "medium", "no_new_risks": false, "category_id": 1, "account_id": null, "test_domain_id": 11, "results": [{"id": 21035427307, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427308, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427309, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427310, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427311, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427312, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427313, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427314, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427315, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427316, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427317, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427318, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427319, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427320, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427321, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427322, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}, {"id": 21035427323, "result": 2, "resource": null, "message": "CloudTrail is not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 252}]}]}, {"id": 91, "name": "2.8 Ensure Rotation for Customer Created CMKs is Enabled", "description": "AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 241, "cloud": "aws", "query": "kmsKeyRotation", "title": "KMS Key Rotation", "description": "Ensures KMS keys are set to rotate on a regular schedule", "more_info": "All KMS keys should have key rotation enabled. AWS will handle the rotation of the encryption key itself, as well as storage of previous keys, so previous data does not need to be re-encrypted before the rotation occurs.", "recommended_action": "Enable yearly rotation for the KMS key", "cs_link": "https://avd.aquasec.com/cspm/aws/kms/kms-key-rotation", "link": "http://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html", "deep_link": "https://console.aws.amazon.com/iam/home?region={region}#/encryptionKeys/us-east-1", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 81, "account_id": null, "test_domain_id": 10, "results": [{"id": 21035427055, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427056, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427057, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427138, "result": 0, "resource": null, "message": "No KMS keys found", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427139, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427140, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427141, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427142, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427143, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427144, "result": 0, "resource": null, "message": "No KMS keys found", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427145, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427146, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427147, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427148, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427149, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427150, "result": 0, "resource": null, "message": "No KMS keys found", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}, {"id": 21035427151, "result": 0, "resource": null, "message": "No KMS keys found", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 241}]}]}, {"id": 92, "name": "2.9 Ensure VPC Flow Logging is Enabled in All VPCs", "description": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 254, "cloud": "aws", "query": "flowLogsEnabled", "title": "VPC Flow Logs Enabled", "description": "Ensures VPC flow logs are enabled for traffic logging", "more_info": "VPC flow logs record all traffic flowing in to and out of a VPC. These logs are critical for auditing and review after security incidents.", "recommended_action": "Enable VPC flow logs for each VPC", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/vpc-flow-logs-enabled", "link": "http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html", "deep_link": "https://console.aws.amazon.com/vpc/home?region={region}#vpcs:", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035427341, "result": 2, "resource": "arn:aws:ec2:us-east-1:824888891866:vpc/vpc-0a3f4e1834152c63e", "message": "VPC flow logs are not enabled", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427342, "result": 2, "resource": "arn:aws:ec2:us-east-2:824888891866:vpc/vpc-0d5a598b0b6ae09dc", "message": "VPC flow logs are not enabled", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427343, "result": 2, "resource": "arn:aws:ec2:us-west-1:824888891866:vpc/vpc-044982e7fb47846b4", "message": "VPC flow logs are not enabled", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427344, "result": 2, "resource": "arn:aws:ec2:us-west-2:824888891866:vpc/vpc-0dad837d21c887068", "message": "VPC flow logs are not enabled", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427345, "result": 2, "resource": "arn:aws:ec2:ca-central-1:824888891866:vpc/vpc-0bb5f7bc67399cd02", "message": "VPC flow logs are not enabled", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427346, "result": 2, "resource": "arn:aws:ec2:eu-central-1:824888891866:vpc/vpc-0e022b4f23827763b", "message": "VPC flow logs are not enabled", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427347, "result": 2, "resource": "arn:aws:ec2:eu-west-1:824888891866:vpc/vpc-0a5696625afbb9280", "message": "VPC flow logs are not enabled", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427348, "result": 2, "resource": "arn:aws:ec2:eu-west-2:824888891866:vpc/vpc-029b7daf421fd3f86", "message": "VPC flow logs are not enabled", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427349, "result": 2, "resource": "arn:aws:ec2:eu-west-3:824888891866:vpc/vpc-01d970672e4d42512", "message": "VPC flow logs are not enabled", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427350, "result": 2, "resource": "arn:aws:ec2:eu-north-1:824888891866:vpc/vpc-02ba4054988a5d600", "message": "VPC flow logs are not enabled", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427351, "result": 2, "resource": "arn:aws:ec2:ap-northeast-1:824888891866:vpc/vpc-0f89a6a6acce1d799", "message": "VPC flow logs are not enabled", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427352, "result": 2, "resource": "arn:aws:ec2:ap-northeast-2:824888891866:vpc/vpc-097002f7760064366", "message": "VPC flow logs are not enabled", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427353, "result": 2, "resource": "arn:aws:ec2:ap-southeast-1:824888891866:vpc/vpc-08a2ca016e3520c2e", "message": "VPC flow logs are not enabled", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427354, "result": 2, "resource": "arn:aws:ec2:ap-southeast-2:824888891866:vpc/vpc-0f3f8c1abfe1e0218", "message": "VPC flow logs are not enabled", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427355, "result": 2, "resource": "arn:aws:ec2:ap-northeast-3:824888891866:vpc/vpc-039148ffa7d69e6d0", "message": "VPC flow logs are not enabled", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427356, "result": 2, "resource": "arn:aws:ec2:ap-south-1:824888891866:vpc/vpc-0a1877810bbb220db", "message": "VPC flow logs are not enabled", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}, {"id": 21035427357, "result": 2, "resource": "arn:aws:ec2:sa-east-1:824888891866:vpc/vpc-074363bb0c60c3b06", "message": "VPC flow logs are not enabled", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 254}]}]}, {"id": 93, "name": "3.1 Ensure a Log Metric Filter and Alarm Exist for Unauthorized API Calls", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 94, "name": "3.2 Ensure a Log Metric Filter and Alarm Exist for Management Console Sign-In Without MFA", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA).", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 95, "name": "3.3 Ensure a Log Metric Filter and Alarm Exist for Usage of Root Account", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 96, "name": "3.4 Ensure a Log Metric Filter and Alarm Exist for IAM Policy Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 98, "name": "3.5 Ensure a Log Metric Filter and Alarm Exist for CloudTrail Configuration Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 99, "name": "3.6 Ensure a Log Metric Filter and Alarm Exist for AWS Management Console Authentication Failures", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 100, "name": "3.7 Ensure a Log Metric Filter and Alarm Exist for Disabling or Scheduled Deletion of Customer Created CMKs", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 101, "name": "3.8 Ensure a Log Metric Filter and Alarm Exist for S3 Bucket Policy Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 102, "name": "3.9 Ensure a Log Metric Filter and Alarm Exist for AWS Config Configuration Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 103, "name": "3.10 Ensure a Log Metric Filter and Alarm Exist for Security Group Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. It is recommended that a metric filter and alarm be established changes to Security Groups.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 104, "name": "3.11 Ensure a Log Metric Filter and Alarm Exist for Changes to Network Access Control Lists (NACL)", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 105, "name": "3.12 Ensure a Log Metric Filter and Alarm Exist for Changes to Network Gateways", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 106, "name": "3.13 Ensure a Log Metric Filter and Alarm Exist for Route Table Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 107, "name": "3.14 Ensure a Log Metric Filter and Alarm Exist for VPC Changes", "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 285, "cloud": "aws", "query": "monitoringMetrics", "title": "CloudWatch Monitoring Metrics", "description": "Ensures metric filters are setup for CloudWatch logs to detect security risks from CloudTrail.", "more_info": "Sending CloudTrail logs to CloudWatch is only useful if metrics are setup to detect risky activity from those logs. There are numerous metrics that should be used. For the exact filter patterns, please see this plugin on GitHub: https://github.com/cloudsploit/scans/blob/master/plugins/aws/cloudwatchlogs/monitoringMetrics.js", "recommended_action": "Enable metric filters to detect malicious activity in CloudTrail logs sent to CloudWatch.", "cs_link": "https://avd.aquasec.com/cspm/aws/cloudwatchlogs/cloudwatch-monitoring-metrics/", "link": "http://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html", "deep_link": "https://console.aws.amazon.com/cloudwatch/home?region={region}#metricsV2:", "action_text": null, "action_link": null, "default": false, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "low", "no_new_risks": false, "category_id": 88, "account_id": null, "test_domain_id": 11, "results": []}]}, {"id": 108, "name": "4.1 Ensure No Security Groups Allow Ingress from 0.0.0.0/0 to Port 22", "description": "Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22 .", "program_id": 22, "tests": [{"remediation_apis": ["EC2:authorizeSecurityGroupIngress", "EC2:revokeSecurityGroupIngress"], "realtime_triggers": ["ec2:AuthorizeSecurityGroupIngress", "ec2:ModifySecurityGroupRules"], "asl": null, "id": 8, "cloud": "aws", "query": "openSSH", "title": "Open SSH", "description": "Determine if TCP port 22 for SSH is open to the public", "more_info": "While some ports such as HTTP and HTTPS are required to be open to the public to function properly, more sensitive services such as SSH should be restricted to known IP addresses.", "recommended_action": "Restrict TCP port 22 to known IP addresses", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/open-ssh", "link": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html", "deep_link": "https://console.aws.amazon.com/ec2/v2/home?region={region}#SecurityGroups", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006020730", "remediation_description": "The impacted security group rule will be deleted if no input is provided. Otherwise, any input will replace the open CIDR rule.", "severity": "high", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035426698, "result": 0, "resource": "arn:aws:ec2:us-east-1:824888891866:security-group/sg-072c5bfd6aadfc30d", "message": "Security group: sg-072c5bfd6aadfc30d (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426699, "result": 0, "resource": "arn:aws:ec2:us-east-2:824888891866:security-group/sg-07a394e50e9216a3a", "message": "Security group: sg-07a394e50e9216a3a (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426700, "result": 0, "resource": "arn:aws:ec2:us-west-1:824888891866:security-group/sg-0610dc9ded5dead8a", "message": "Security group: sg-0610dc9ded5dead8a (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426701, "result": 0, "resource": "arn:aws:ec2:us-west-2:824888891866:security-group/sg-0a8d47846252a1fb1", "message": "Security group: sg-0a8d47846252a1fb1 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426702, "result": 0, "resource": "arn:aws:ec2:ca-central-1:824888891866:security-group/sg-0ab25016c5d4d2b0d", "message": "Security group: sg-0ab25016c5d4d2b0d (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426703, "result": 0, "resource": "arn:aws:ec2:eu-central-1:824888891866:security-group/sg-083efc10a19bd4933", "message": "Security group: sg-083efc10a19bd4933 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426704, "result": 0, "resource": "arn:aws:ec2:eu-west-1:824888891866:security-group/sg-0d5a0cde2429c1629", "message": "Security group: sg-0d5a0cde2429c1629 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426705, "result": 0, "resource": "arn:aws:ec2:eu-west-2:824888891866:security-group/sg-049e428d8f47554bb", "message": "Security group: sg-049e428d8f47554bb (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426706, "result": 0, "resource": "arn:aws:ec2:eu-west-3:824888891866:security-group/sg-07f6b0fb5a2d76e69", "message": "Security group: sg-07f6b0fb5a2d76e69 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426707, "result": 0, "resource": "arn:aws:ec2:eu-north-1:824888891866:security-group/sg-01b45114371ecaed2", "message": "Security group: sg-01b45114371ecaed2 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426708, "result": 0, "resource": "arn:aws:ec2:ap-northeast-1:824888891866:security-group/sg-0888f34257be1bee5", "message": "Security group: sg-0888f34257be1bee5 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426709, "result": 0, "resource": "arn:aws:ec2:ap-northeast-2:824888891866:security-group/sg-0fc1f48924c0e68ef", "message": "Security group: sg-0fc1f48924c0e68ef (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426710, "result": 0, "resource": "arn:aws:ec2:ap-southeast-1:824888891866:security-group/sg-0623687cd792da4e9", "message": "Security group: sg-0623687cd792da4e9 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426711, "result": 0, "resource": "arn:aws:ec2:ap-southeast-2:824888891866:security-group/sg-03f9cde20c4555189", "message": "Security group: sg-03f9cde20c4555189 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426712, "result": 0, "resource": "arn:aws:ec2:ap-northeast-3:824888891866:security-group/sg-01312238e53d0fd33", "message": "Security group: sg-01312238e53d0fd33 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426713, "result": 0, "resource": "arn:aws:ec2:ap-south-1:824888891866:security-group/sg-0a5e8671810c7429e", "message": "Security group: sg-0a5e8671810c7429e (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}, {"id": 21035426714, "result": 0, "resource": "arn:aws:ec2:sa-east-1:824888891866:security-group/sg-0e596dc5603d01971", "message": "Security group: sg-0e596dc5603d01971 (default) does not have TCP:22 open to 0.0.0.0/0 or ::0", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 8}]}]}, {"id": 109, "name": "4.2 Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389", "description": "Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389 .", "program_id": 22, "tests": [{"remediation_apis": ["EC2:authorizeSecurityGroupIngress", "EC2:revokeSecurityGroupIngress"], "realtime_triggers": ["ec2:AuthorizeSecurityGroupIngress", "ec2:ModifySecurityGroupRules"], "asl": null, "id": 17, "cloud": "aws", "query": "openRDP", "title": "Open RDP", "description": "Determine if TCP port 3389 for RDP is open to the public", "more_info": "While some ports such as HTTP and HTTPS are required to be open to the public to function properly, more sensitive services such as RDP should be restricted to known IP addresses.", "recommended_action": "Restrict TCP port 3389 to known IP addresses", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/open-rdp", "link": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html", "deep_link": "https://console.aws.amazon.com/ec2/v2/home?region={region}#SecurityGroups", "action_text": null, "action_link": null, "default": true, "remediation": true, "remediation_min_version": "202006020730", "remediation_description": "The impacted security group rule will be deleted if no input is provided. Otherwise, any input will replace the open CIDR rule.", "severity": "medium", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035426851, "result": 0, "resource": "arn:aws:ec2:us-east-1:824888891866:security-group/sg-072c5bfd6aadfc30d", "message": "Security group: sg-072c5bfd6aadfc30d (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426852, "result": 0, "resource": "arn:aws:ec2:us-east-2:824888891866:security-group/sg-07a394e50e9216a3a", "message": "Security group: sg-07a394e50e9216a3a (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426853, "result": 0, "resource": "arn:aws:ec2:us-west-1:824888891866:security-group/sg-0610dc9ded5dead8a", "message": "Security group: sg-0610dc9ded5dead8a (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426854, "result": 0, "resource": "arn:aws:ec2:us-west-2:824888891866:security-group/sg-0a8d47846252a1fb1", "message": "Security group: sg-0a8d47846252a1fb1 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426855, "result": 0, "resource": "arn:aws:ec2:ca-central-1:824888891866:security-group/sg-0ab25016c5d4d2b0d", "message": "Security group: sg-0ab25016c5d4d2b0d (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426856, "result": 0, "resource": "arn:aws:ec2:eu-central-1:824888891866:security-group/sg-083efc10a19bd4933", "message": "Security group: sg-083efc10a19bd4933 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426857, "result": 0, "resource": "arn:aws:ec2:eu-west-1:824888891866:security-group/sg-0d5a0cde2429c1629", "message": "Security group: sg-0d5a0cde2429c1629 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426858, "result": 0, "resource": "arn:aws:ec2:eu-west-2:824888891866:security-group/sg-049e428d8f47554bb", "message": "Security group: sg-049e428d8f47554bb (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426859, "result": 0, "resource": "arn:aws:ec2:eu-west-3:824888891866:security-group/sg-07f6b0fb5a2d76e69", "message": "Security group: sg-07f6b0fb5a2d76e69 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426860, "result": 0, "resource": "arn:aws:ec2:eu-north-1:824888891866:security-group/sg-01b45114371ecaed2", "message": "Security group: sg-01b45114371ecaed2 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426861, "result": 0, "resource": "arn:aws:ec2:ap-northeast-1:824888891866:security-group/sg-0888f34257be1bee5", "message": "Security group: sg-0888f34257be1bee5 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426862, "result": 0, "resource": "arn:aws:ec2:ap-northeast-2:824888891866:security-group/sg-0fc1f48924c0e68ef", "message": "Security group: sg-0fc1f48924c0e68ef (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426863, "result": 0, "resource": "arn:aws:ec2:ap-southeast-1:824888891866:security-group/sg-0623687cd792da4e9", "message": "Security group: sg-0623687cd792da4e9 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426864, "result": 0, "resource": "arn:aws:ec2:ap-southeast-2:824888891866:security-group/sg-03f9cde20c4555189", "message": "Security group: sg-03f9cde20c4555189 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426865, "result": 0, "resource": "arn:aws:ec2:ap-northeast-3:824888891866:security-group/sg-01312238e53d0fd33", "message": "Security group: sg-01312238e53d0fd33 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426866, "result": 0, "resource": "arn:aws:ec2:ap-south-1:824888891866:security-group/sg-0a5e8671810c7429e", "message": "Security group: sg-0a5e8671810c7429e (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}, {"id": 21035426867, "result": 0, "resource": "arn:aws:ec2:sa-east-1:824888891866:security-group/sg-0e596dc5603d01971", "message": "Security group: sg-0e596dc5603d01971 (default) does not have TCP:3389 open to 0.0.0.0/0 or ::0", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:15.000Z", "scan_id": 7626590, "test_id": 17}]}]}, {"id": 110, "name": "4.3 Ensure the Default Security Group of Every VPC Restricts All Traffic", "description": "A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic.", "program_id": 22, "tests": [{"remediation_apis": null, "realtime_triggers": null, "asl": null, "id": 255, "cloud": "aws", "query": "defaultSecurityGroup", "title": "Default Security Group", "description": "Ensure the default security groups block all traffic by default", "more_info": "The default security group is often used for resources launched without a defined security group. For this reason, the default rules should be to block all traffic to prevent an accidental exposure.", "recommended_action": "Update the rules for the default security group to deny all traffic by default", "cs_link": "https://avd.aquasec.com/cspm/aws/ec2/default-security-group", "link": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html#default-security-group", "deep_link": "https://console.aws.amazon.com/vpc/home?region={region}#securityGroups:filter=default", "action_text": null, "action_link": null, "default": true, "remediation": false, "remediation_min_version": null, "remediation_description": null, "severity": "medium", "no_new_risks": false, "category_id": 3, "account_id": null, "test_domain_id": 5, "results": [{"id": 21035427358, "result": 2, "resource": "arn:aws:ec2:us-east-1:824888891866:security-group/sg-072c5bfd6aadfc30d", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "us-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427359, "result": 2, "resource": "arn:aws:ec2:us-east-2:824888891866:security-group/sg-07a394e50e9216a3a", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "us-east-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427360, "result": 2, "resource": "arn:aws:ec2:us-west-1:824888891866:security-group/sg-0610dc9ded5dead8a", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "us-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427361, "result": 2, "resource": "arn:aws:ec2:us-west-2:824888891866:security-group/sg-0a8d47846252a1fb1", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "us-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427362, "result": 2, "resource": "arn:aws:ec2:ca-central-1:824888891866:security-group/sg-0ab25016c5d4d2b0d", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ca-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427363, "result": 2, "resource": "arn:aws:ec2:eu-central-1:824888891866:security-group/sg-083efc10a19bd4933", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "eu-central-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427364, "result": 2, "resource": "arn:aws:ec2:eu-west-1:824888891866:security-group/sg-0d5a0cde2429c1629", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "eu-west-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427365, "result": 2, "resource": "arn:aws:ec2:eu-west-2:824888891866:security-group/sg-049e428d8f47554bb", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "eu-west-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427366, "result": 2, "resource": "arn:aws:ec2:eu-west-3:824888891866:security-group/sg-07f6b0fb5a2d76e69", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "eu-west-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427367, "result": 2, "resource": "arn:aws:ec2:eu-north-1:824888891866:security-group/sg-01b45114371ecaed2", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "eu-north-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427368, "result": 2, "resource": "arn:aws:ec2:ap-northeast-1:824888891866:security-group/sg-0888f34257be1bee5", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-northeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427369, "result": 2, "resource": "arn:aws:ec2:ap-northeast-2:824888891866:security-group/sg-0fc1f48924c0e68ef", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-northeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427370, "result": 2, "resource": "arn:aws:ec2:ap-southeast-1:824888891866:security-group/sg-0623687cd792da4e9", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-southeast-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427371, "result": 2, "resource": "arn:aws:ec2:ap-southeast-2:824888891866:security-group/sg-03f9cde20c4555189", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-southeast-2", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427372, "result": 2, "resource": "arn:aws:ec2:ap-northeast-3:824888891866:security-group/sg-01312238e53d0fd33", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-northeast-3", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427373, "result": 2, "resource": "arn:aws:ec2:ap-south-1:824888891866:security-group/sg-0a5e8671810c7429e", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "ap-south-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}, {"id": 21035427374, "result": 2, "resource": "arn:aws:ec2:sa-east-1:824888891866:security-group/sg-0e596dc5603d01971", "message": "Default security group has 1 inbound and 1 outbound rules", "region": "sa-east-1", "discovered": 0, "custom": 0, "created": "2022-11-24T09:49:16.000Z", "scan_id": 7626590, "test_id": 255}]}]}]}